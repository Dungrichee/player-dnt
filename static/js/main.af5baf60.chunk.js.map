{"version":3,"sources":["../../src/i18n/vi/index.ts","../../src/i18n/en/index.ts","../../src/i18n/index.ts","../../src/utils/video.ts","../../src/components/camera_name/styles.ts","../../src/components/camera_name/index.tsx","../../src/components/loading/styles.ts","../../src/types/player.ts","../../src/components/loading/index.tsx","../../src/components/control_bar/button_wrapper/index.tsx","../../src/components/control_bar/play_toggle/index.tsx","../../src/components/control_bar/refresh/index.tsx","../../src/components/control_bar/mode_options/styles.ts","../../src/components/control_bar/mode_options/index.tsx","../../src/components/control_bar/alarm_toggle/index.tsx","../../src/components/control_bar/snapshot/index.tsx","../../src/components/control_bar/theater_mode/index.tsx","../../src/components/control_bar/follow_toggle/index.tsx","../../src/components/control_bar/fullscreen_toggle/index.tsx","../../src/utils/common.ts","../../src/components/control_bar/ptz_toggle/index.tsx","../../src/components/control_bar/volume/index.tsx","../../node_modules/babel-plugin-transform-async-to-promises/helpers.mjs","../../src/components/control_bar/mic/index.tsx","../../src/components/control_bar/styles.ts","../../src/components/control_bar/index.tsx","../../src/utils/log.ts","../../src/utils/fullscreen.ts","../../src/components/shortcut/index.tsx","../../src/components/player_webrtc/redux_store/webrtc/slice.ts","../../src/components/player_webrtc/redux_store/root_reducer.ts","../../src/components/player_webrtc/redux_store/webrtc/action.ts","../../src/components/player_webrtc/manager.ts","../../src/components/player_webrtc/video/status/index.tsx","../../src/components/player_webrtc/video/styles.ts","../../src/components/player_webrtc/redux_store/store.ts","../../src/components/player_webrtc/controller/signaling.ts","../../src/components/player_webrtc/controller/rtc.ts","../../src/components/player_webrtc/video/index.tsx","../../src/components/player_webrtc/player/styles.ts","../../src/components/player_webrtc/player/index.tsx","../../src/components/player_hls/video/styles.ts","../../src/components/player_hls/video/status/index.tsx","../../src/components/player_hls/video/index.tsx","../../src/components/player_hls/redux_store/player/player_slice.ts","../../src/components/player_hls/redux_store/root_reducer.ts","../../src/components/player_hls/redux_store/player/player_action.ts","../../src/components/player_hls/manager.ts","../../src/components/player_hls/player/styles.ts","../../src/components/player_hls/player/index.tsx","../../src/index.tsx","data.ts","App.tsx","index.tsx"],"names":["vi","Object","assign","controlBar","en","i18n","use","Backend","LanguageDetector","initReactI18next","init","lng","fallbackLng","debug","interpolation","escapeValue","resources","translation","find","elements","func","filter","isTypeEqual","component1","component2","type1","type","type2","displayName","mergeAndSortChildren","defaultChildren","_children","_parentProps","defaultOrder","children","React","Children","toArray","parentProps","e","props","disabled","concat","c","component","map","element","defaultComponent","defaultProps","cloneElement","sort","a","b","order","useStyles","makeStyles","camName","display","position","color","top","left","right","textAlign","paddingTop","CameraName","classes","cam","name","Box","className","Typography","noWrap","fontSize","fontWeight","CameraStatusEnum","loading","marginLeft","marginTop","load","noLoad","Loading","player","waiting","clsx","CircularProgress","size","style","ButtonWrapper","title","Icon","icon","_props$placement","placement","_props$disablePortal","disablePortal","handleClick","Tooltip","PopperProps","IconButton","onClick","PlayToggle","t","manager","hidePlay","paused","PlayArrow","Pause","video","error","handlePlay","handlePause","Refresh","actions","status","ERROR","OFFLINE","hideRefresh","RefreshRounded","setError","startPlayer","root","alignItems","cursor","disabledBadge","backgroundColor","DotWithText","id","text","changeStreamMode","useState","optionId","setOptionId","Badge","anchorOrigin","vertical","horizontal","overlap","variant","badge","undefined","ml","ModeOptions","modeOptions","AlarmToggle","showAlarm","isAlarm","AlarmOnOutlined","AlarmOffOutlined","rtc","pc","toggleAlarm","stopAlarm","startAlarm","Snapshot","hideSnapshot","CameraAltOutlined","snapshot","TheaterMode","theaterMode","isTheaterMode","toggleTheaterMode","MapOutlined","Crop169Outlined","FollowToggle","follow","unFollow","VisibilityOffOutlined","FullscreenToggle","isFullscreen","hideFullscreen","FullscreenExitOutlined","FullscreenOutlined","rootElement","toggleFullscreen","toastMessage","message","toast","PTZToggle","ptz","isEnabledPTZ","togglePTZ","ControlCamera","isSupportPtz","Volume","isEnabledSpeaker","showVolume","isMuted","VolumeOffOutlined","VolumeUpOutlined","isSupportAudio","unmute","muted","mute","Symbol","iterator","asyncIterator","_catch","body","recover","result","then","MicToggle","isAudioStarting","getAudioDevice","navigator","mediaDevices","getUserMedia","audio","echoCancellation","localStream","window","console","log","isEnabledMic","showMic","MicOutlined","MicOffOutlined","_exit","lcStream","startAudio","stopAudio","opacity","visibility","bottom","height","marginBottom","flexDirection","transformStyle","flex","ControlBar","hide","key","getLeftChildren","getRightChildren","isDebug","debugLog","request","elm","requestFullscreen","webkitRequestFullscreen","mozRequestFullscreen","msRequestFullscreen","_proto","exit","document","exitFullscreen","addEventListener","handler","removeEventListener","_createClass","fullscreenElement","fullscreenEnabled","Shortcut","useEffect","fullscreen","exitHandler","changeFullscreen","playerSlice","createSlice","initialState","isWsOpen","isAudioNotSupport","reducers","state","action","payload","play","playing","canPlay","canPlayThrough","pause","setIsAudioNotSupport","wsOpenSuccess","setPeerConnectionIssue","peerConnectionIssue","reducer","rootReducer","this","videoHeight","videoWidth","canvas","createElement","context","getContext","width","fillRect","drawImage","link","setAttribute","Date","getTime","toDataURL","replace","click","enabled","Manager","store","configureStore","devTools","getState","getActions","dispatch","playerActions","otherActions","keys","reduce","boundActions","actionCreator","self","_this","args","apply","bindActionCreator","subscribeToStateChange","listener","bind","preState","subscribe","prevStateCopy","subscribeToPlayerStateChange","_this2","VideoStatus","wsOpen","setLoading","des","reconnect","sx","transform","Fragment","mb","setTimeout","VideoWrapper","styled","outline","VideoStyled","signaling","connect","newDebug","serverAddress","ws","WebSocket","onopen","wsOnOpen","onmessage","wsOnMessage","wsAuth","token","sendMessage","parsedMessage","JSON","parse","data","viewerId","_this3","rtcList","get","authenStatus","createPcPeerConnection","viewerResponse","iceCandidate","candidate","remoteDescription","addIceCandidate","sdpMid","sdpMLineIndex","iceCandidateQueue","push","warn","addRtc","set","jsonMessage","stringify","readyState","OPEN","send","errorMsg","dispose","sdpAnswer","acceptOffer","close","timeoutId","clearTimeout","disconnectNumber","clear","CLOSED","Map","peerConnectionLimit","RTCConfig","iceServers","urls","username","credential","iceTransportPolicy","RTC","_this4","_this5","initTrack","cameraId","getNetWorkStatus","getStats","stats","forEach","report","startAudioStream","getAudioTracks","track","addTrack","stopAudioStream","stop","onIceCandidate","RTCPeerConnection","setInterval","audioStarting","onicecandidate","ontrack","srcObject","streams","onicecandidateerror","ev","errorText","onconnectionstatechange","timeout","iceConnectionState","peerConnectionTimeoutId","createOffer","detail","offerToReceiveAudio","offerToReceiveVideo","offer","sdpOffer","sdp","setLocalDescription","setRemoteDescription","length","shift","toggleAudio","clearInterval","onnegotiationneeded","onicegatheringstatechange","onsignalingstatechange","uuidv4","NORMAL","WARNING","Video","_inheritsLoose","rtcAudio","componentDidMount","componentDidUpdate","prevProps","componentWillUnmount","stopPlayer","renderContent","_this$props2$player","_this$props2$player$i","ref","autoPlay","onError","handleError","onPlay","onPlaying","handlePlaying","onCanPlay","handleCanPlay","onPause","onCanPlayThrough","handleCanPlayThrough","render","val","Component","VideoDanaPlayer","background","maxHeight","PlayerRTC","propsWithoutChildren","getDefaultChildren","forceUpdate","handleStateChange","getChildren","hlsOption","backBufferLength","xhrSetup","xhr","setRequestHeader","hidden","hls","destroy","destroyHls","Hls","resetHls","isSupported","detachMedia","attachMedia","on","Events","MEDIA_ATTACHED","path","loadSource","MANIFEST_PARSED","promise","seeking","seeked","onPauseVideo","_event","fatal","ErrorTypes","NETWORK_ERROR","networkDetails","startLoad","MEDIA_ERROR","recoverMediaError","crossOrigin","onSeeking","onSeeked","onEnded","onWaiting","showControlBar","playToggle","controlBarActive","Player","renderControlBar","onMouseEnter","handleMouseEnter","onMouseLeave","handleMouseLeave","PlayerStream","I18nextProvider","PlayerHls","cameras","lat","address","ip","portOnvif","portRtsp","isSharedLink","recordMaxKeepDay","isSyncDateTime","App","_useSignaling$wsOpen","setWsOpen","useSignaling","ReactDOM","getElementById"],"mappings":"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","file":"static/js/main.af5baf60.chunk.js","sourcesContent":["import controlBar from './control_bar.json';\r\n\r\nconst vi = Object.assign(controlBar);\r\nexport default vi;\r\n","import controlBar from './control_bar.json';\r\n\r\nconst en = Object.assign(controlBar);\r\n\r\nexport default en;\r\n","import i18n from 'i18next';\r\nimport Backend from 'i18next-http-backend';\r\nimport LanguageDetector from 'i18next-browser-languagedetector';\r\nimport { initReactI18next } from 'react-i18next';\r\n\r\nimport vi from './vi';\r\nimport en from './en';\r\n\r\ni18n\r\n  .use(Backend)\r\n  .use(LanguageDetector)\r\n  .use(initReactI18next)\r\n  .init({\r\n    lng: 'vi',\r\n    fallbackLng: 'vi',\r\n    debug: false,\r\n    interpolation: {\r\n      escapeValue: false,\r\n    },\r\n    resources: {\r\n      vi: {\r\n        translation: vi,\r\n      },\r\n      en: {\r\n        translation: en,\r\n      },\r\n    },\r\n  });\r\n\r\nexport default i18n;\r\n","import React, { ReactNode } from 'react';\r\nimport { IPlayerProps, IPlayerWebRTCProps } from 'types/player';\r\n\r\nconst find = (elements: any[], func: any) => elements.filter(func)[0];\r\n\r\nconst isTypeEqual = (component1: any, component2: any) => {\r\n  const type1 = component1.type;\r\n  const type2 = component2.type;\r\n\r\n  if (typeof type1 === 'string' || typeof type2 === 'string') {\r\n    return type1.displayName === type2.displayName;\r\n  }\r\n\r\n  return false;\r\n};\r\n\r\nexport function mergeAndSortChildren(\r\n  defaultChildren: ReactNode[],\r\n  _children: ReactNode,\r\n  _parentProps: IPlayerWebRTCProps | IPlayerProps,\r\n  defaultOrder = 1,\r\n) {\r\n  const children = React.Children.toArray(_children);\r\n  const { ...parentProps } = _parentProps;\r\n  return children\r\n    .filter((e: any) => !e.props.disabled)\r\n    .concat(\r\n      defaultChildren.filter((c: ReactNode) => !find(children, (component: ReactNode) => isTypeEqual(component, c))),\r\n    )\r\n    .map((element: any) => {\r\n      const defaultComponent = find(defaultChildren, (c: any) => isTypeEqual(c, element));\r\n      const defaultProps = defaultComponent ? defaultComponent.props : {};\r\n\r\n      const props = Object.assign(parentProps, defaultProps, element.props);\r\n\r\n      const e = React.cloneElement(element, props, element.props.children);\r\n      return e;\r\n    })\r\n    .sort((a, b) => (a.props.order || defaultOrder) - b.props.order || defaultOrder);\r\n}\r\n","import { makeStyles } from '@mui/styles';\r\n\r\nconst useStyles = makeStyles(() => ({\r\n  camName: {\r\n    display: 'block',\r\n    position: 'absolute',\r\n    color: '#fff',\r\n    top: 0,\r\n    left: 12,\r\n    right: 12,\r\n    textAlign: 'left',\r\n    paddingTop: 8,\r\n  },\r\n}));\r\n\r\nexport default useStyles;\r\n","import React from 'react';\r\nimport { Box, Typography } from '@mui/material';\r\n\r\nimport { IPlayerWebRTCProps } from 'types/player';\r\nimport useStyles from './styles';\r\n\r\nfunction CameraName(props: any) {\r\n  const classes = useStyles();\r\n\r\n  const {\r\n    cam: { name = '' }\r\n  } = props as IPlayerWebRTCProps;\r\n\r\n  return (\r\n    <Box className={classes.camName}>\r\n      <Typography noWrap fontSize={16} fontWeight={600}>\r\n        {name}\r\n      </Typography>\r\n    </Box>\r\n  );\r\n}\r\n\r\nexport default CameraName;\r\n","import { makeStyles } from '@mui/styles';\r\n\r\nconst useStyles = makeStyles(() => ({\r\n  loading: {\r\n    color: '#fff',\r\n    position: 'absolute',\r\n    top: '50%',\r\n    left: '50%',\r\n    marginLeft: -30,\r\n    marginTop: -30,\r\n    display: 'none',\r\n  },\r\n  load: {\r\n    display: 'block',\r\n  },\r\n  noLoad: {\r\n    display: 'none',\r\n  },\r\n}));\r\n\r\nexport default useStyles;\r\n","import { Store } from '@reduxjs/toolkit';\r\n\r\nimport Video from 'components/player_webrtc/video';\r\n\r\nexport type TStreamMode = 'live' | 'playback';\r\n\r\nexport enum CameraStatusEnum {\r\n  NORMAL = 'normal',\r\n  WARNING = 'warning',\r\n  ERROR = 'error',\r\n  OFFLINE = 'offline',\r\n}\r\n\r\nexport interface IManager {\r\n  rootElement: HTMLElement;\r\n  store: Store;\r\n  video: Video | null;\r\n}\r\n\r\nexport interface IActions {\r\n  snapshot: () => void;\r\n  toggleFullscreen: (rootEl: HTMLElement | null, player: IPlayerWebRTCSlice) => void;\r\n  changeFullscreen: (isFullscreen: boolean) => void;\r\n  play: () => void;\r\n  pause: () => void;\r\n  waiting: () => void;\r\n  playing: () => void;\r\n  canPlay: () => void;\r\n  canPlayThrough: () => void;\r\n  setError: (payload: { message: string; detail?: string } | null) => void;\r\n}\r\n\r\nexport interface IPlayerHlsActions extends IActions {\r\n  playToggle: () => void;\r\n  seeking: () => void;\r\n  seeked: () => void;\r\n  playing: () => void;\r\n  controlBarActive: (active: boolean) => void;\r\n}\r\n\r\nexport interface IPlayerWebRTCActions extends IActions {\r\n  mute: () => void;\r\n  unmute: () => void;\r\n  startAlarm: () => void;\r\n  stopAlarm: () => void;\r\n  startAudio: () => void;\r\n  stopAudio: () => void;\r\n  setIsAudioNotSupport: () => void;\r\n  setPeerConnectionIssue: (payload: number) => void;\r\n  wsOpenSuccess: () => void;\r\n}\r\n\r\nexport interface IPlayerWebRTCSlice {\r\n  paused: boolean;\r\n  isFullscreen: boolean;\r\n  waiting: boolean;\r\n  isWsOpen: boolean;\r\n  isMuted: boolean;\r\n  isAudioStarting: boolean;\r\n  isAlarm: boolean;\r\n  isAudioNotSupport: boolean;\r\n  error: {\r\n    message: string;\r\n    detail?: string;\r\n  } | null;\r\n  peerConnectionIssue?: number;\r\n}\r\n\r\nexport interface IPlayerHlsSlice {\r\n  paused: boolean;\r\n  isFullscreen: boolean;\r\n  waiting: boolean;\r\n  seeking: boolean;\r\n  error: { message: string; detail?: string } | null;\r\n  showControlBar: boolean;\r\n}\r\n\r\nexport interface ICamProps {\r\n  name: string;\r\n  status: 'normal' | 'warning' | 'offline' | 'error';\r\n  id: string;\r\n  isSupportAudio?: boolean;\r\n  isSupportPtz?: boolean;\r\n  isEnabledMic?: boolean;\r\n  isEnabledPTZ?: boolean;\r\n  isEnabledSpeaker?: boolean;\r\n}\r\n\r\nexport interface IPlayerWebRTCControlBar {\r\n  hide?: boolean;\r\n  hidePlay?: boolean;\r\n  hideRefresh?: boolean;\r\n  hideSnapshot?: boolean;\r\n  hideFullscreen?: boolean;\r\n  showMic?: boolean;\r\n  showAlarm?: boolean;\r\n  showVolume?: boolean;\r\n  ptz?: {\r\n    togglePTZ: () => void;\r\n  };\r\n  modeOptions?: {\r\n    changeStreamMode: () => void;\r\n  };\r\n  follow?: {\r\n    unFollow: () => void;\r\n  };\r\n  theaterMode?: {\r\n    isTheaterMode: boolean;\r\n    toggleTheaterMode: () => void;\r\n  };\r\n}\r\n\r\nexport interface IPlayerProps {\r\n  manager: IManager;\r\n  cam: ICamProps;\r\n  actions: IPlayerHlsActions;\r\n  player: IPlayerWebRTCSlice | IPlayerHlsSlice;\r\n  controlBar?: IPlayerWebRTCControlBar;\r\n  order?: number;\r\n  key?: string;\r\n  store: Store;\r\n}\r\n\r\nexport interface IPlayerWebRTCProps {\r\n  manager: IManager;\r\n  actions: IPlayerWebRTCActions;\r\n  player: IPlayerWebRTCSlice;\r\n  cam: ICamProps;\r\n  store: Store;\r\n  isTheaterMode?: boolean;\r\n  controlBar?: IPlayerWebRTCControlBar;\r\n  order?: number;\r\n  key?: string;\r\n}\r\n\r\n// export interface IPlayerHlsProps {\r\n//   actions: IActions;\r\n//   cam: ICamProps;\r\n//   isTheaterMode?: boolean;\r\n//   manager: IManager | Manager;\r\n//   player: IPlayer;\r\n//   store: Store;\r\n//   order?: number;\r\n//   key?: string;\r\n// }\r\n\r\n// export interface IPlayerWebRTCActions {\r\n//   snapshot: () => void;\r\n//   toggleFullscreen: (rootEl: HTMLElement | null, player: IPlayerWebRTCSlice) => void;\r\n//   changeFullscreen: (isFullscreen: boolean) => void;\r\n//   play: () => void;\r\n//   pause: () => void;\r\n//   waiting: () => void;\r\n//   mute: () => void;\r\n//   unmute: () => void;\r\n//   playing: () => void;\r\n//   canPlay: () => void;\r\n//   canPlayThrough: () => void;\r\n//   startAlarm: () => void;\r\n//   stopAlarm: () => void;\r\n//   startAudio: () => void;\r\n//   stopAudio: () => void;\r\n//   setError: (payload: { message: string; detail?: string } | null) => void;\r\n//   setIsAudioNotSupport: () => void;\r\n//   setPeerConnectionIssue: (payload: number) => void;\r\n//   wsOpenSuccess: () => void;\r\n// }\r\n\r\ndeclare global {\r\n  interface Window {\r\n    localStream?: MediaStream;\r\n  }\r\n\r\n  interface IPlayerStreamProps {}\r\n}\r\n","import React from 'react';\r\nimport { Box, CircularProgress } from '@mui/material';\r\nimport { clsx } from 'clsx';\r\n\r\nimport { IPlayerWebRTCProps } from 'types/player';\r\nimport useStyles from './styles';\r\n\r\nfunction Loading(props: any) {\r\n  const classes = useStyles();\r\n  const {\r\n    player: { waiting = false },\r\n  } = props as IPlayerWebRTCProps;\r\n\r\n  return (\r\n    <Box\r\n      className={clsx(classes.loading, {\r\n        [classes.load]: waiting,\r\n      })}\r\n    >\r\n      <CircularProgress size={60} style={{ color: '#fff' }} />\r\n    </Box>\r\n  );\r\n}\r\n\r\nexport default Loading;\r\n","import React from 'react';\nimport { Box, IconButton, Tooltip } from '@mui/material';\n\ninterface IButtonWrapper {\n  title: string;\n  icon: any;\n  handleClick: () => void;\n  disablePortal?: boolean;\n  placement?:\n    | 'bottom'\n    | 'left'\n    | 'right'\n    | 'top'\n    | 'top-start'\n    | 'bottom-end'\n    | 'bottom-start'\n    | 'left-end'\n    | 'left-start'\n    | 'right-end'\n    | 'right-start'\n    | 'top-end';\n}\n\nfunction ButtonWrapper(props: IButtonWrapper) {\n  const { title, icon: Icon, placement = 'top', disablePortal = false, handleClick } = props;\n  return (\n    <Box>\n      <Tooltip\n        title={title}\n        placement={placement}\n        PopperProps={{\n          disablePortal: disablePortal,\n        }}\n      >\n        <IconButton onClick={handleClick} size=\"small\">\n          <Icon fontSize=\"small\" />\n        </IconButton>\n      </Tooltip>\n    </Box>\n  );\n}\n\nexport default ButtonWrapper;\n","import React from 'react';\r\nimport { Pause, PlayArrow } from '@mui/icons-material';\r\n\r\nimport i18n from 'i18n';\r\nimport { IPlayerWebRTCProps } from 'types/player';\r\nimport ButtonWrapper from '../button_wrapper';\r\n\r\nfunction PlayToggle(props: any) {\r\n  const { t } = i18n;\r\n\r\n  const { player, manager, controlBar } = props as IPlayerWebRTCProps;\r\n\r\n  if (controlBar?.hidePlay) return null;\r\n\r\n  const title = player.paused ? t('controlBar.play.false') : t('controlBar.play.true');\r\n\r\n  const handleClick = () => {\r\n    const { video } = manager;\r\n\r\n    if (player.error || !video) return;\r\n    // if (player.error || !video || !video?.rtc?.pc) return;\r\n\r\n    if (player.paused) {\r\n      video.handlePlay();\r\n    } else {\r\n      video.handlePause();\r\n    }\r\n  };\r\n\r\n  return (\r\n    <ButtonWrapper\r\n      title={title}\r\n      icon={player.paused ? PlayArrow : Pause}\r\n      handleClick={handleClick}\r\n      placement=\"top-start\"\r\n      disablePortal\r\n    />\r\n  );\r\n}\r\n\r\nexport default PlayToggle;\r\n","import React from 'react';\r\nimport { RefreshRounded } from '@mui/icons-material';\r\n\r\nimport i18n from 'i18n';\r\nimport { IPlayerWebRTCProps } from 'types/player';\r\nimport { CameraStatusEnum } from 'types/player';\r\nimport ButtonWrapper from '../button_wrapper';\r\n\r\nfunction Refresh(props: any) {\r\n  const {\r\n    manager: { video },\r\n    player,\r\n    actions,\r\n    cam,\r\n    controlBar,\r\n    \r\n  } = props as IPlayerWebRTCProps;\r\n\r\n  if (cam.status === CameraStatusEnum.ERROR || cam.status === CameraStatusEnum.OFFLINE || controlBar?.hideRefresh)\r\n    return null;\r\n\r\n  const { t } = i18n;\r\n\r\n  const handleClick = () => {\r\n    if (!video || player.waiting) return;\r\n\r\n    if (player.error) {\r\n      actions.setError(null);\r\n    }\r\n\r\n    video.startPlayer();\r\n  };\r\n\r\n  const title = t('controlBar.refresh');\r\n\r\n  return <ButtonWrapper title={title} icon={RefreshRounded} handleClick={handleClick} disablePortal />;\r\n}\r\n\r\nexport default Refresh;\r\n","import { makeStyles } from '@mui/styles';\r\n\r\nexport const useStyles = makeStyles(() => ({\r\n  root: {\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    marginLeft: 16,\r\n    cursor: 'pointer',\r\n    '&:first-child': {\r\n      marginLeft: 8,\r\n    },\r\n  },\r\n  disabledBadge: {\r\n    backgroundColor: '#B2BEC3 !important',\r\n  },\r\n}));\r\n","import React, { useState } from 'react';\r\nimport { Badge, Box, Typography } from '@mui/material';\r\n\r\nimport i18n from 'i18n';\r\nimport { useStyles } from './styles';\r\nimport { IPlayerWebRTCProps, TStreamMode } from 'types/player';\r\n\r\ntype IColor = 'default' | 'success' | 'primary' | 'secondary' | 'error' | 'info' | 'warning';\r\n\r\ninterface IDotWithText {\r\n  color?: IColor;\r\n  text: string;\r\n  id: TStreamMode;\r\n  changeStreamMode: () => void;\r\n}\r\n\r\nfunction DotWithText(props: IDotWithText) {\r\n  const { id, color, text, changeStreamMode } = props;\r\n  const [optionId, setOptionId] = useState('');\r\n  const classes = useStyles();\r\n\r\n  const handleClick = () => {\r\n    if (optionId === id) return;\r\n\r\n    setOptionId(id);\r\n    return changeStreamMode();\r\n  };\r\n\r\n  return (\r\n    <Box onClick={handleClick} className={classes.root}>\r\n      <Badge\r\n        anchorOrigin={{ vertical: 'bottom', horizontal: 'right' }}\r\n        overlap=\"circular\"\r\n        color={color}\r\n        variant=\"dot\"\r\n        classes={{ badge: !color ? classes.disabledBadge : undefined }}\r\n      />\r\n      <Typography variant=\"body2\" ml={1} color=\"white\">\r\n        {text}\r\n      </Typography>\r\n    </Box>\r\n  );\r\n}\r\n\r\nfunction ModeOptions(props: any) {\r\n  const { controlBar } = props as IPlayerWebRTCProps;\r\n  const { t } = i18n;\r\n\r\n  if (!controlBar?.modeOptions) return null;\r\n\r\n  const { changeStreamMode } = controlBar.modeOptions;\r\n\r\n  return (\r\n    <Box display=\"flex\" alignItems=\"center\">\r\n      <DotWithText text={t('controlBar.mode.record')} id=\"playback\" changeStreamMode={changeStreamMode} />\r\n      <DotWithText text={t('controlBar.mode.live')} id=\"live\" color=\"error\" changeStreamMode={changeStreamMode} />\r\n    </Box>\r\n  );\r\n}\r\n\r\nexport default ModeOptions;\r\n","import React from 'react';\r\nimport { AlarmOffOutlined, AlarmOnOutlined } from '@mui/icons-material';\r\n\r\nimport { IPlayerWebRTCProps } from 'types/player';\r\nimport i18n from 'i18n';\r\nimport ButtonWrapper from '../button_wrapper';\r\n\r\nfunction AlarmToggle(props: any) {\r\n  const { actions, player, manager, controlBar } = props as IPlayerWebRTCProps;\r\n  const { t } = i18n;\r\n\r\n  if (!controlBar?.showAlarm) return null;\r\n\r\n  const title = player.isAlarm ? t('controlBar.alarm.off') : t('controlBar.alarm.on');\r\n\r\n  const handleClick = async () => {\r\n    const { video } = manager;\r\n    if (player.error || !video?.rtc?.pc) return;\r\n\r\n    if (player.isAlarm) {\r\n      video.rtc.toggleAlarm('stopAlarm');\r\n      actions.stopAlarm();\r\n    } else {\r\n      video.rtc.toggleAlarm('startAlarm');\r\n      actions.startAlarm();\r\n    }\r\n  };\r\n\r\n  return (\r\n    <ButtonWrapper title={title} icon={player.isAlarm ? AlarmOnOutlined : AlarmOffOutlined} handleClick={handleClick} />\r\n  );\r\n}\r\n\r\nexport default AlarmToggle;\r\n","import React from 'react';\r\nimport { CameraAltOutlined } from '@mui/icons-material';\r\n\r\nimport i18n from 'i18n';\r\nimport { IPlayerWebRTCProps } from 'types/player';\r\nimport ButtonWrapper from '../button_wrapper';\r\n\r\nfunction Snapshot(props: any) {\r\n  const { actions, player, manager, controlBar } = props as IPlayerWebRTCProps;\r\n  const { video } = manager;\r\n  const { t } = i18n;\r\n\r\n  const title = t('controlBar.snapshot');\r\n\r\n  const handleClick = () => {\r\n    if (player.error || !video) return;\r\n    // if (player.error || !video?.rtc?.pc) return;\r\n    actions.snapshot();\r\n  };\r\n\r\n  if (controlBar?.hideSnapshot) return null;\r\n\r\n  return <ButtonWrapper title={title} icon={CameraAltOutlined} handleClick={handleClick} />;\r\n}\r\n\r\nexport default Snapshot;\r\n","import React from 'react';\r\nimport { Crop169Outlined, MapOutlined } from '@mui/icons-material';\r\n\r\nimport i18n from 'i18n';\r\nimport { IPlayerWebRTCProps } from 'types/player';\r\nimport ButtonWrapper from '../button_wrapper';\r\n\r\nfunction TheaterMode(props: any) {\r\n  const { controlBar } = props as IPlayerWebRTCProps;\r\n\r\n  if (!controlBar?.theaterMode) return null;\r\n\r\n  const { isTheaterMode, toggleTheaterMode } = controlBar.theaterMode;\r\n\r\n  const { t } = i18n;\r\n\r\n  const title = !isTheaterMode ? t('controlBar.theaterMode.false') : t('controlBar.theaterMode.true');\r\n\r\n  const handleClick = () => {\r\n    toggleTheaterMode();\r\n  };\r\n\r\n  return (\r\n    <ButtonWrapper\r\n      title={title}\r\n      icon={isTheaterMode ? MapOutlined : Crop169Outlined}\r\n      placement=\"top-start\"\r\n      handleClick={handleClick}\r\n      disablePortal\r\n    />\r\n  );\r\n}\r\n\r\nexport default TheaterMode;\r\n","import React from 'react';\r\nimport { VisibilityOffOutlined } from '@mui/icons-material';\r\n\r\nimport i18n from 'i18n';\r\nimport { IPlayerWebRTCProps } from 'types/player';\r\nimport ButtonWrapper from '../button_wrapper';\r\n\r\nfunction FollowToggle(props: any) {\r\n  const { controlBar } = props as IPlayerWebRTCProps;\r\n\r\n  if (!controlBar?.follow) return null;\r\n\r\n  const { unFollow } = controlBar.follow;\r\n  const { t } = i18n;\r\n\r\n  const title = t('controlBar.unFollow');\r\n\r\n  const handleClick = () => unFollow();\r\n\r\n  return <ButtonWrapper title={title} icon={VisibilityOffOutlined} handleClick={handleClick} disablePortal />;\r\n}\r\n\r\nexport default FollowToggle;\r\n","import React from 'react';\r\nimport { FullscreenExitOutlined, FullscreenOutlined } from '@mui/icons-material';\r\n\r\nimport i18n from 'i18n';\r\nimport ButtonWrapper from '../button_wrapper';\r\nimport { IPlayerWebRTCProps } from 'types/player';\r\n\r\nfunction FullscreenToggle(props: any) {\r\n  const { actions, player, manager, controlBar } = props as IPlayerWebRTCProps;\r\n  const { t } = i18n;\r\n\r\n  const title = player.isFullscreen ? t('controlBar.fullScreen.true') : t('controlBar.fullScreen.false');\r\n\r\n  const handleClick = () => {\r\n    const { video, rootElement } = manager;\r\n    if (player.error || !video) return;\r\n    // if (player.error || !video?.rtc?.pc) return;\r\n\r\n    actions.toggleFullscreen(rootElement, player);\r\n  };\r\n\r\n  if (controlBar?.hideFullscreen) return null;\r\n\r\n  return (\r\n    <ButtonWrapper\r\n      title={title}\r\n      icon={player.isFullscreen ? FullscreenExitOutlined : FullscreenOutlined}\r\n      handleClick={handleClick}\r\n      placement=\"top-end\"\r\n      // disablePortal\r\n    />\r\n  );\r\n}\r\n\r\nexport default FullscreenToggle;\r\n","import toast from 'react-hot-toast';\r\n\r\nexport const toastMessage = {\r\n  success: (message: string) => toast.success(message),\r\n\r\n  error: (message: string) => toast.error(message || 'Lỗi hệ thống'),\r\n};\r\n","import React from 'react';\r\nimport { ControlCamera } from '@mui/icons-material';\r\n\r\nimport i18n from 'i18n';\r\nimport { toastMessage } from 'utils/common';\r\nimport { IPlayerWebRTCProps } from 'types/player';\r\nimport ButtonWrapper from '../button_wrapper';\r\n\r\nfunction PTZToggle(props: any) {\r\n  const { cam, controlBar } = props as IPlayerWebRTCProps;\r\n  const { t } = i18n;\r\n\r\n  if (!controlBar?.ptz || !cam.isEnabledPTZ) return null;\r\n\r\n  const { togglePTZ } = controlBar.ptz;\r\n\r\n  const handleClick = () => {\r\n    if (!cam.isSupportPtz) return toastMessage.error(t('controlBar.ptz.isNotSupported'));\r\n    togglePTZ();\r\n    return;\r\n  };\r\n\r\n  const title = t('controlBar.ptz.isSupported');\r\n\r\n  return (\r\n    <ButtonWrapper title={title} icon={ControlCamera} handleClick={handleClick} placement=\"top-start\" disablePortal />\r\n  );\r\n}\r\n\r\nexport default PTZToggle;\r\n","import React from 'react';\r\nimport { VolumeOffOutlined, VolumeUpOutlined } from '@mui/icons-material';\r\n\r\nimport i18n from 'i18n';\r\nimport { IPlayerWebRTCProps } from 'types/player';\r\nimport { toastMessage } from 'utils/common';\r\nimport ButtonWrapper from '../button_wrapper';\r\n\r\nfunction Volume(props: any) {\r\n  const { actions, player, manager, cam, controlBar } = props as IPlayerWebRTCProps;\r\n  const { t } = i18n;\r\n\r\n  if (!cam.isEnabledSpeaker || !controlBar?.showVolume) return null;\r\n\r\n  const title = player.isMuted ? t('controlBar.volume.off') : t('controlBar.volume.on');\r\n\r\n  const handleClick = async () => {\r\n    const { video } = manager;\r\n    if (player.error || !video?.rtc?.pc) return;\r\n\r\n    if (player.isMuted) {\r\n      if (!cam.isSupportAudio) return toastMessage.error(t('controlBar.audio.isNotSupported'));\r\n      actions.unmute();\r\n      video.muted = false;\r\n    } else {\r\n      video.muted = true;\r\n      actions.mute();\r\n    }\r\n\r\n    return;\r\n  };\r\n\r\n  return (\r\n    <ButtonWrapper\r\n      title={title}\r\n      icon={player.isMuted ? VolumeOffOutlined : VolumeUpOutlined}\r\n      handleClick={handleClick}\r\n      disablePortal\r\n    />\r\n  );\r\n}\r\n\r\nexport default Volume;\r\n","// A type of promise-like that resolves synchronously and supports only one observer\nexport const _Pact = /*#__PURE__*/(function() {\n\tfunction _Pact() {}\n\t_Pact.prototype.then = function(onFulfilled, onRejected) {\n\t\tconst result = new _Pact();\n\t\tconst state = this.s;\n\t\tif (state) {\n\t\t\tconst callback = state & 1 ? onFulfilled : onRejected;\n\t\t\tif (callback) {\n\t\t\t\ttry {\n\t\t\t\t\t_settle(result, 1, callback(this.v));\n\t\t\t\t} catch (e) {\n\t\t\t\t\t_settle(result, 2, e);\n\t\t\t\t}\n\t\t\t\treturn result;\n\t\t\t} else {\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}\n\t\tthis.o = function(_this) {\n\t\t\ttry {\n\t\t\t\tconst value = _this.v;\n\t\t\t\tif (_this.s & 1) {\n\t\t\t\t\t_settle(result, 1, onFulfilled ? onFulfilled(value) : value);\n\t\t\t\t} else if (onRejected) {\n\t\t\t\t\t_settle(result, 1, onRejected(value));\n\t\t\t\t} else {\n\t\t\t\t\t_settle(result, 2, value);\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\t_settle(result, 2, e);\n\t\t\t}\n\t\t};\n\t\treturn result;\n\t}\n\treturn _Pact;\n})();\n\n// Settles a pact synchronously\nexport function _settle(pact, state, value) {\n\tif (!pact.s) {\n\t\tif (value instanceof _Pact) {\n\t\t\tif (value.s) {\n\t\t\t\tif (state & 1) {\n\t\t\t\t\tstate = value.s;\n\t\t\t\t}\n\t\t\t\tvalue = value.v;\n\t\t\t} else {\n\t\t\t\tvalue.o = _settle.bind(null, pact, state);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tif (value && value.then) {\n\t\t\tvalue.then(_settle.bind(null, pact, state), _settle.bind(null, pact, 2));\n\t\t\treturn;\n\t\t}\n\t\tpact.s = state;\n\t\tpact.v = value;\n\t\tconst observer = pact.o;\n\t\tif (observer) {\n\t\t\tobserver(pact);\n\t\t}\n\t}\n}\n\nexport function _isSettledPact(thenable) {\n\treturn thenable instanceof _Pact && thenable.s & 1;\n}\n\n// Converts argument to a function that always returns a Promise\nexport function _async(f) {\n\treturn function() {\n\t\tfor (var args = [], i = 0; i < arguments.length; i++) {\n\t\t\targs[i] = arguments[i];\n\t\t}\n\t\ttry {\n\t\t\treturn Promise.resolve(f.apply(this, args));\n\t\t} catch(e) {\n\t\t\treturn Promise.reject(e);\n\t\t}\n\t}\n}\n\n// Awaits on a value that may or may not be a Promise (equivalent to the await keyword in ES2015, with continuations passed explicitly)\nexport function _await(value, then, direct) {\n\tif (direct) {\n\t\treturn then ? then(value) : value;\n\t}\n\tif (!value || !value.then) {\n\t\tvalue = Promise.resolve(value);\n\t}\n\treturn then ? value.then(then) : value;\n}\n\n// Awaits on a value that may or may not be a Promise, then ignores it\nexport function _awaitIgnored(value, direct) {\n\tif (!direct) {\n\t\treturn value && value.then ? value.then(_empty) : Promise.resolve();\n\t}\n}\n\n// Proceeds after a value has resolved, or proceeds immediately if the value is not thenable\nexport function _continue(value, then) {\n\treturn value && value.then ? value.then(then) : then(value);\n}\n\n// Proceeds after a value has resolved, or proceeds immediately if the value is not thenable\nexport function _continueIgnored(value) {\n\tif (value && value.then) {\n\t\treturn value.then(_empty);\n\t}\n}\n\n// Asynchronously iterate through an object that has a length property, passing the index as the first argument to the callback (even as the length property changes)\nexport function _forTo(array, body, check) {\n\tvar i = -1, pact, reject;\n\tfunction _cycle(result) {\n\t\ttry {\n\t\t\twhile (++i < array.length && (!check || !check())) {\n\t\t\t\tresult = body(i);\n\t\t\t\tif (result && result.then) {\n\t\t\t\t\tif (_isSettledPact(result)) {\n\t\t\t\t\t\tresult = result.v;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresult.then(_cycle, reject || (reject = _settle.bind(null, pact = new _Pact(), 2)));\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (pact) {\n\t\t\t\t_settle(pact, 1, result);\n\t\t\t} else {\n\t\t\t\tpact = result;\n\t\t\t}\n\t\t} catch (e) {\n\t\t\t_settle(pact || (pact = new _Pact()), 2, e);\n\t\t}\n\t}\n\t_cycle();\n\treturn pact;\n}\n\n// Asynchronously iterate through an object's properties (including properties inherited from the prototype)\n// Uses a snapshot of the object's properties\nexport function _forIn(target, body, check) {\n\tvar keys = [];\n\tfor (var key in target) {\n\t\tkeys.push(key);\n\t}\n\treturn _forTo(keys, function(i) { return body(keys[i]); }, check);\n}\n\n// Asynchronously iterate through an object's own properties (excluding properties inherited from the prototype)\n// Uses a snapshot of the object's properties\nexport function _forOwn(target, body, check) {\n\tvar keys = [];\n\tfor (var key in target) {\n\t\tif (Object.prototype.hasOwnProperty.call(target, key)) {\n\t\t\tkeys.push(key);\n\t\t}\n\t}\n\treturn _forTo(keys, function(i) { return body(keys[i]); }, check);\n}\n\nexport const _iteratorSymbol = /*#__PURE__*/ typeof Symbol !== \"undefined\" ? (Symbol.iterator || (Symbol.iterator = Symbol(\"Symbol.iterator\"))) : \"@@iterator\";\n\n// Asynchronously iterate through an object's values\n// Uses for...of if the runtime supports it, otherwise iterates until length on a copy\nexport function _forOf(target, body, check) {\n\tif (typeof target[_iteratorSymbol] === \"function\") {\n\t\tvar iterator = target[_iteratorSymbol](), step, pact, reject;\n\t\tfunction _cycle(result) {\n\t\t\ttry {\n\t\t\t\twhile (!(step = iterator.next()).done && (!check || !check())) {\n\t\t\t\t\tresult = body(step.value);\n\t\t\t\t\tif (result && result.then) {\n\t\t\t\t\t\tif (_isSettledPact(result)) {\n\t\t\t\t\t\t\tresult = result.v;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tresult.then(_cycle, reject || (reject = _settle.bind(null, pact = new _Pact(), 2)));\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (pact) {\n\t\t\t\t\t_settle(pact, 1, result);\n\t\t\t\t} else {\n\t\t\t\t\tpact = result;\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\t_settle(pact || (pact = new _Pact()), 2, e);\n\t\t\t}\n\t\t}\n\t\t_cycle();\n\t\tif (iterator.return) {\n\t\t\tvar _fixup = function(value) {\n\t\t\t\ttry {\n\t\t\t\t\tif (!step.done) {\n\t\t\t\t\t\titerator.return();\n\t\t\t\t\t}\n\t\t\t\t} catch(e) {\n\t\t\t\t}\n\t\t\t\treturn value;\n\t\t\t}\n\t\t\tif (pact && pact.then) {\n\t\t\t\treturn pact.then(_fixup, function(e) {\n\t\t\t\t\tthrow _fixup(e);\n\t\t\t\t});\n\t\t\t}\n\t\t\t_fixup();\n\t\t}\n\t\treturn pact;\n\t}\n\t// No support for Symbol.iterator\n\tif (!(\"length\" in target)) {\n\t\tthrow new TypeError(\"Object is not iterable\");\n\t}\n\t// Handle live collections properly\n\tvar values = [];\n\tfor (var i = 0; i < target.length; i++) {\n\t\tvalues.push(target[i]);\n\t}\n\treturn _forTo(values, function(i) { return body(values[i]); }, check);\n}\n\nexport const _asyncIteratorSymbol = /*#__PURE__*/ typeof Symbol !== \"undefined\" ? (Symbol.asyncIterator || (Symbol.asyncIterator = Symbol(\"Symbol.asyncIterator\"))) : \"@@asyncIterator\";\n\n// Asynchronously iterate on a value using it's async iterator if present, or its synchronous iterator if missing\nexport function _forAwaitOf(target, body, check) {\n\tif (typeof target[_asyncIteratorSymbol] === \"function\") {\n\t\tvar pact = new _Pact();\n\t\tvar iterator = target[_asyncIteratorSymbol]();\n\t\titerator.next().then(_resumeAfterNext).then(void 0, _reject);\n\t\treturn pact;\n\t\tfunction _resumeAfterBody(result) {\n\t\t\tif (check && check()) {\n\t\t\t\treturn _settle(pact, 1, iterator.return ? iterator.return().then(function() { return result; }) : result);\n\t\t\t}\n\t\t\titerator.next().then(_resumeAfterNext).then(void 0, _reject);\n\t\t}\n\t\tfunction _resumeAfterNext(step) {\n\t\t\tif (step.done) {\n\t\t\t\t_settle(pact, 1);\n\t\t\t} else {\n\t\t\t\tPromise.resolve(body(step.value)).then(_resumeAfterBody).then(void 0, _reject);\n\t\t\t}\n\t\t}\n\t\tfunction _reject(error) {\n\t\t\t_settle(pact, 2, iterator.return ? iterator.return().then(function() { return error; }) : error);\n\t\t}\n\t}\n\treturn Promise.resolve(_forOf(target, function(value) { return Promise.resolve(value).then(body); }, check));\n}\n\n// Asynchronously implement a generic for loop\nexport function _for(test, update, body) {\n\tvar stage;\n\tfor (;;) {\n\t\tvar shouldContinue = test();\n\t\tif (_isSettledPact(shouldContinue)) {\n\t\t\tshouldContinue = shouldContinue.v;\n\t\t}\n\t\tif (!shouldContinue) {\n\t\t\treturn result;\n\t\t}\n\t\tif (shouldContinue.then) {\n\t\t\tstage = 0;\n\t\t\tbreak;\n\t\t}\n\t\tvar result = body();\n\t\tif (result && result.then) {\n\t\t\tif (_isSettledPact(result)) {\n\t\t\t\tresult = result.s;\n\t\t\t} else {\n\t\t\t\tstage = 1;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (update) {\n\t\t\tvar updateValue = update();\n\t\t\tif (updateValue && updateValue.then && !_isSettledPact(updateValue)) {\n\t\t\t\tstage = 2;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\tvar pact = new _Pact();\n\tvar reject = _settle.bind(null, pact, 2);\n\t(stage === 0 ? shouldContinue.then(_resumeAfterTest) : stage === 1 ? result.then(_resumeAfterBody) : updateValue.then(_resumeAfterUpdate)).then(void 0, reject);\n\treturn pact;\n\tfunction _resumeAfterBody(value) {\n\t\tresult = value;\n\t\tdo {\n\t\t\tif (update) {\n\t\t\t\tupdateValue = update();\n\t\t\t\tif (updateValue && updateValue.then && !_isSettledPact(updateValue)) {\n\t\t\t\t\tupdateValue.then(_resumeAfterUpdate).then(void 0, reject);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\tshouldContinue = test();\n\t\t\tif (!shouldContinue || (_isSettledPact(shouldContinue) && !shouldContinue.v)) {\n\t\t\t\t_settle(pact, 1, result);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (shouldContinue.then) {\n\t\t\t\tshouldContinue.then(_resumeAfterTest).then(void 0, reject);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tresult = body();\n\t\t\tif (_isSettledPact(result)) {\n\t\t\t\tresult = result.v;\n\t\t\t}\n\t\t} while (!result || !result.then);\n\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t}\n\tfunction _resumeAfterTest(shouldContinue) {\n\t\tif (shouldContinue) {\n\t\t\tresult = body();\n\t\t\tif (result && result.then) {\n\t\t\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t\t\t} else {\n\t\t\t\t_resumeAfterBody(result);\n\t\t\t}\n\t\t} else {\n\t\t\t_settle(pact, 1, result);\n\t\t}\n\t}\n\tfunction _resumeAfterUpdate() {\n\t\tif (shouldContinue = test()) {\n\t\t\tif (shouldContinue.then) {\n\t\t\t\tshouldContinue.then(_resumeAfterTest).then(void 0, reject);\n\t\t\t} else {\n\t\t\t\t_resumeAfterTest(shouldContinue);\n\t\t\t}\n\t\t} else {\n\t\t\t_settle(pact, 1, result);\n\t\t}\n\t}\n}\n\n// Asynchronously implement a do ... while loop\nexport function _do(body, test) {\n\tvar awaitBody;\n\tdo {\n\t\tvar result = body();\n\t\tif (result && result.then) {\n\t\t\tif (_isSettledPact(result)) {\n\t\t\t\tresult = result.v;\n\t\t\t} else {\n\t\t\t\tawaitBody = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tvar shouldContinue = test();\n\t\tif (_isSettledPact(shouldContinue)) {\n\t\t\tshouldContinue = shouldContinue.v;\n\t\t}\n\t\tif (!shouldContinue) {\n\t\t\treturn result;\n\t\t}\n\t} while (!shouldContinue.then);\n\tconst pact = new _Pact();\n\tconst reject = _settle.bind(null, pact, 2);\n\t(awaitBody ? result.then(_resumeAfterBody) : shouldContinue.then(_resumeAfterTest)).then(void 0, reject);\n\treturn pact;\n\tfunction _resumeAfterBody(value) {\n\t\tresult = value;\n\t\tfor (;;) {\n\t\t\tshouldContinue = test();\n\t\t\tif (_isSettledPact(shouldContinue)) {\n\t\t\t\tshouldContinue = shouldContinue.v;\n\t\t\t}\n\t\t\tif (!shouldContinue) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (shouldContinue.then) {\n\t\t\t\tshouldContinue.then(_resumeAfterTest).then(void 0, reject);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tresult = body();\n\t\t\tif (result && result.then) {\n\t\t\t\tif (_isSettledPact(result)) {\n\t\t\t\t\tresult = result.v;\n\t\t\t\t} else {\n\t\t\t\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t_settle(pact, 1, result);\n\t}\n\tfunction _resumeAfterTest(shouldContinue) {\n\t\tif (shouldContinue) {\n\t\t\tdo {\n\t\t\t\tresult = body();\n\t\t\t\tif (result && result.then) {\n\t\t\t\t\tif (_isSettledPact(result)) {\n\t\t\t\t\t\tresult = result.v;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tshouldContinue = test();\n\t\t\t\tif (_isSettledPact(shouldContinue)) {\n\t\t\t\t\tshouldContinue = shouldContinue.v;\n\t\t\t\t}\n\t\t\t\tif (!shouldContinue) {\n\t\t\t\t\t_settle(pact, 1, result);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t} while (!shouldContinue.then);\n\t\t\tshouldContinue.then(_resumeAfterTest).then(void 0, reject);\n\t\t} else {\n\t\t\t_settle(pact, 1, result);\n\t\t}\n\t}\n}\n\n// Asynchronously implement a switch statement\nexport function _switch(discriminant, cases) {\n\tvar dispatchIndex = -1;\n\tvar awaitBody;\n\touter: {\n\t\tfor (var i = 0; i < cases.length; i++) {\n\t\t\tvar test = cases[i][0];\n\t\t\tif (test) {\n\t\t\t\tvar testValue = test();\n\t\t\t\tif (testValue && testValue.then) {\n\t\t\t\t\tbreak outer;\n\t\t\t\t}\n\t\t\t\tif (testValue === discriminant) {\n\t\t\t\t\tdispatchIndex = i;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Found the default case, set it as the pending dispatch case\n\t\t\t\tdispatchIndex = i;\n\t\t\t}\n\t\t}\n\t\tif (dispatchIndex !== -1) {\n\t\t\tdo {\n\t\t\t\tvar body = cases[dispatchIndex][1];\n\t\t\t\twhile (!body) {\n\t\t\t\t\tdispatchIndex++;\n\t\t\t\t\tbody = cases[dispatchIndex][1];\n\t\t\t\t}\n\t\t\t\tvar result = body();\n\t\t\t\tif (result && result.then) {\n\t\t\t\t\tawaitBody = true;\n\t\t\t\t\tbreak outer;\n\t\t\t\t}\n\t\t\t\tvar fallthroughCheck = cases[dispatchIndex][2];\n\t\t\t\tdispatchIndex++;\n\t\t\t} while (fallthroughCheck && !fallthroughCheck());\n\t\t\treturn result;\n\t\t}\n\t}\n\tconst pact = new _Pact();\n\tconst reject = _settle.bind(null, pact, 2);\n\t(awaitBody ? result.then(_resumeAfterBody) : testValue.then(_resumeAfterTest)).then(void 0, reject);\n\treturn pact;\n\tfunction _resumeAfterTest(value) {\n\t\tfor (;;) {\n\t\t\tif (value === discriminant) {\n\t\t\t\tdispatchIndex = i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (++i === cases.length) {\n\t\t\t\tif (dispatchIndex !== -1) {\n\t\t\t\t\tbreak;\n\t\t\t\t} else {\n\t\t\t\t\t_settle(pact, 1, result);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\ttest = cases[i][0];\n\t\t\tif (test) {\n\t\t\t\tvalue = test();\n\t\t\t\tif (value && value.then) {\n\t\t\t\t\tvalue.then(_resumeAfterTest).then(void 0, reject);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tdispatchIndex = i;\n\t\t\t}\n\t\t}\n\t\tdo {\n\t\t\tvar body = cases[dispatchIndex][1];\n\t\t\twhile (!body) {\n\t\t\t\tdispatchIndex++;\n\t\t\t\tbody = cases[dispatchIndex][1];\n\t\t\t}\n\t\t\tvar result = body();\n\t\t\tif (result && result.then) {\n\t\t\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar fallthroughCheck = cases[dispatchIndex][2];\n\t\t\tdispatchIndex++;\n\t\t} while (fallthroughCheck && !fallthroughCheck());\n\t\t_settle(pact, 1, result);\n\t}\n\tfunction _resumeAfterBody(result) {\n\t\tfor (;;) {\n\t\t\tvar fallthroughCheck = cases[dispatchIndex][2];\n\t\t\tif (!fallthroughCheck || fallthroughCheck()) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tdispatchIndex++;\n\t\t\tvar body = cases[dispatchIndex][1];\n\t\t\twhile (!body) {\n\t\t\t\tdispatchIndex++;\n\t\t\t\tbody = cases[dispatchIndex][1];\n\t\t\t}\n\t\t\tresult = body();\n\t\t\tif (result && result.then) {\n\t\t\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t_settle(pact, 1, result);\n\t}\n}\n\n// Asynchronously call a function and pass the result to explicitly passed continuations\nexport function _call(body, then, direct) {\n\tif (direct) {\n\t\treturn then ? then(body()) : body();\n\t}\n\ttry {\n\t\tvar result = Promise.resolve(body());\n\t\treturn then ? result.then(then) : result;\n\t} catch (e) {\n\t\treturn Promise.reject(e);\n\t}\n}\n\n// Asynchronously call a function and swallow the result\nexport function _callIgnored(body, direct) {\n\treturn _call(body, _empty, direct);\n}\n\n// Asynchronously call a function and pass the result to explicitly passed continuations\nexport function _invoke(body, then) {\n\tvar result = body();\n\tif (result && result.then) {\n\t\treturn result.then(then);\n\t}\n\treturn then(result);\n}\n\n// Asynchronously call a function and swallow the result\nexport function _invokeIgnored(body) {\n\tvar result = body();\n\tif (result && result.then) {\n\t\treturn result.then(_empty);\n\t}\n}\n\n// Asynchronously call a function and send errors to recovery continuation\nexport function _catch(body, recover) {\n\ttry {\n\t\tvar result = body();\n\t} catch(e) {\n\t\treturn recover(e);\n\t}\n\tif (result && result.then) {\n\t\treturn result.then(void 0, recover);\n\t}\n\treturn result;\n}\n\n// Asynchronously await a promise and pass the result to a finally continuation\nexport function _finallyRethrows(body, finalizer) {\n\ttry {\n\t\tvar result = body();\n\t} catch (e) {\n\t\treturn finalizer(true, e);\n\t}\n\tif (result && result.then) {\n\t\treturn result.then(finalizer.bind(null, false), finalizer.bind(null, true));\n\t}\n\treturn finalizer(false, result);\n}\n\n// Asynchronously await a promise and invoke a finally continuation that always overrides the result\nexport function _finally(body, finalizer) {\n\ttry {\n\t\tvar result = body();\n\t} catch (e) {\n\t\treturn finalizer();\n\t}\n\tif (result && result.then) {\n\t\treturn result.then(finalizer, finalizer);\n\t}\n\treturn finalizer();\n}\n\n// Rethrow or return a value from a finally continuation\nexport function _rethrow(thrown, value) {\n\tif (thrown)\n\t\tthrow value;\n\treturn value;\n}\n\n// Empty function to implement break and other control flow that ignores asynchronous results\nexport function _empty() {\n}\n\n// Sentinel value for early returns in generators \nexport const _earlyReturn = /*#__PURE__*/ {};\n\n// Asynchronously call a function and send errors to recovery continuation, skipping early returns\nexport function _catchInGenerator(body, recover) {\n\treturn _catch(body, function(e) {\n\t\tif (e === _earlyReturn) {\n\t\t\tthrow e;\n\t\t}\n\t\treturn recover(e);\n\t});\n}\n\n// Asynchronous generator class; accepts the entrypoint of the generator, to which it passes itself when the generator should start\nexport const _AsyncGenerator = /*#__PURE__*/(function() {\n\tfunction _AsyncGenerator(entry) {\n\t\tthis._entry = entry;\n\t\tthis._pact = null;\n\t\tthis._resolve = null;\n\t\tthis._return = null;\n\t\tthis._promise = null;\n\t}\n\n\tfunction _wrapReturnedValue(value) {\n\t\treturn { value: value, done: true };\n\t}\n\tfunction _wrapYieldedValue(value) {\n\t\treturn { value: value, done: false };\n\t}\n\n\t_AsyncGenerator.prototype._yield = function(value) {\n\t\t// Yield the value to the pending next call\n\t\tthis._resolve(value && value.then ? value.then(_wrapYieldedValue) : _wrapYieldedValue(value));\n\t\t// Return a pact for an upcoming next/return/throw call\n\t\treturn this._pact = new _Pact();\n\t};\n\t_AsyncGenerator.prototype.next = function(value) {\n\t\t// Advance the generator, starting it if it has yet to be started\n\t\tconst _this = this;\n\t\treturn _this._promise = new Promise(function (resolve) {\n\t\t\tconst _pact = _this._pact;\n\t\t\tif (_pact === null) {\n\t\t\t\tconst _entry = _this._entry;\n\t\t\t\tif (_entry === null) {\n\t\t\t\t\t// Generator is started, but not awaiting a yield expression\n\t\t\t\t\t// Abandon the next call!\n\t\t\t\t\treturn resolve(_this._promise);\n\t\t\t\t}\n\t\t\t\t// Start the generator\n\t\t\t\t_this._entry = null;\n\t\t\t\t_this._resolve = resolve;\n\t\t\t\tfunction returnValue(value) {\n\t\t\t\t\t_this._resolve(value && value.then ? value.then(_wrapReturnedValue) : _wrapReturnedValue(value));\n\t\t\t\t\t_this._pact = null;\n\t\t\t\t\t_this._resolve = null;\n\t\t\t\t}\n\t\t\t\tvar result = _entry(_this);\n\t\t\t\tif (result && result.then) {\n\t\t\t\t\tresult.then(returnValue, function(error) {\n\t\t\t\t\t\tif (error === _earlyReturn) {\n\t\t\t\t\t\t\treturnValue(_this._return);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tconst pact = new _Pact();\n\t\t\t\t\t\t\t_this._resolve(pact);\n\t\t\t\t\t\t\t_this._pact = null;\n\t\t\t\t\t\t\t_this._resolve = null;\n\t\t\t\t\t\t\t_resolve(pact, 2, error);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\treturnValue(result);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Generator is started and a yield expression is pending, settle it\n\t\t\t\t_this._pact = null;\n\t\t\t\t_this._resolve = resolve;\n\t\t\t\t_settle(_pact, 1, value);\n\t\t\t}\n\t\t});\n\t};\n\t_AsyncGenerator.prototype.return = function(value) {\n\t\t// Early return from the generator if started, otherwise abandons the generator\n\t\tconst _this = this;\n\t\treturn _this._promise = new Promise(function (resolve) {\n\t\t\tconst _pact = _this._pact;\n\t\t\tif (_pact === null) {\n\t\t\t\tif (_this._entry === null) {\n\t\t\t\t\t// Generator is started, but not awaiting a yield expression\n\t\t\t\t\t// Abandon the return call!\n\t\t\t\t\treturn resolve(_this._promise);\n\t\t\t\t}\n\t\t\t\t// Generator is not started, abandon it and return the specified value\n\t\t\t\t_this._entry = null;\n\t\t\t\treturn resolve(value && value.then ? value.then(_wrapReturnedValue) : _wrapReturnedValue(value));\n\t\t\t}\n\t\t\t// Settle the yield expression with a rejected \"early return\" value\n\t\t\t_this._return = value;\n\t\t\t_this._resolve = resolve;\n\t\t\t_this._pact = null;\n\t\t\t_settle(_pact, 2, _earlyReturn);\n\t\t});\n\t};\n\t_AsyncGenerator.prototype.throw = function(error) {\n\t\t// Inject an exception into the pending yield expression\n\t\tconst _this = this;\n\t\treturn _this._promise = new Promise(function (resolve, reject) {\n\t\t\tconst _pact = _this._pact;\n\t\t\tif (_pact === null) {\n\t\t\t\tif (_this._entry === null) {\n\t\t\t\t\t// Generator is started, but not awaiting a yield expression\n\t\t\t\t\t// Abandon the throw call!\n\t\t\t\t\treturn resolve(_this._promise);\n\t\t\t\t}\n\t\t\t\t// Generator is not started, abandon it and return a rejected Promise containing the error\n\t\t\t\t_this._entry = null;\n\t\t\t\treturn reject(error);\n\t\t\t}\n\t\t\t// Settle the yield expression with the value as a rejection\n\t\t\t_this._resolve = resolve;\n\t\t\t_this._pact = null;\n\t\t\t_settle(_pact, 2, error);\n\t\t});\n\t};\n\n\t_AsyncGenerator.prototype[_asyncIteratorSymbol] = function() {\n\t\treturn this;\n\t};\n\t\n\treturn _AsyncGenerator;\n})();\n","import React from 'react';\r\nimport { MicOffOutlined, MicOutlined } from '@mui/icons-material';\r\n\r\nimport i18n from 'i18n';\r\nimport { IPlayerWebRTCProps } from 'types/player';\r\nimport { toastMessage } from 'utils/common';\r\nimport ButtonWrapper from '../button_wrapper';\r\n\r\nfunction MicToggle(props: any) {\r\n  const { actions, player, manager, cam, controlBar } = props as IPlayerWebRTCProps;\r\n  const { t } = i18n;\r\n\r\n  const title = player.isAudioStarting ? t('controlBar.audio.off') : t('controlBar.audio.on');\r\n\r\n  const handleClick = async () => {\r\n    const { video } = manager;\r\n    if (player.error || !video?.rtc?.pc) return;\r\n\r\n    if (player.isAudioStarting) {\r\n      actions.stopAudio();\r\n    } else {\r\n      if (!cam.isSupportAudio) return toastMessage.error(t('controlBar.audio.isNotSupported'));\r\n\r\n      const lcStream = await getAudioDevice();\r\n\r\n      if (!lcStream) return;\r\n      actions.startAudio();\r\n    }\r\n\r\n    return;\r\n  };\r\n\r\n  const getAudioDevice = async () => {\r\n    try {\r\n      const localStream = await navigator.mediaDevices.getUserMedia({\r\n        audio: {\r\n          echoCancellation: true,\r\n        },\r\n      });\r\n      window.localStream = localStream;\r\n      return localStream;\r\n    } catch (error) {\r\n      console.log({ error });\r\n      return toastMessage.error(t('controlBar.audio.isDeviceNotFound'));\r\n    }\r\n  };\r\n\r\n  if (!cam.isEnabledMic || !controlBar?.showMic) return null;\r\n\r\n  return (\r\n    <ButtonWrapper\r\n      title={title}\r\n      icon={player.isAudioStarting ? MicOutlined : MicOffOutlined}\r\n      handleClick={handleClick}\r\n      disablePortal\r\n    />\r\n  );\r\n}\r\n\r\nexport default MicToggle;\r\n","import { makeStyles } from '@mui/styles';\r\n\r\nexport const useStyles = makeStyles(() => ({\r\n  controlBar: {\r\n    position: 'absolute',\r\n    display: 'flex',\r\n    opacity: 0,\r\n    visibility: 'hidden',\r\n    bottom: 0,\r\n    left: 12,\r\n    right: 12,\r\n    height: 36,\r\n    marginBottom: 5,\r\n    flexDirection: 'row',\r\n    transformStyle: 'preserve-3d',\r\n    '& > div': {\r\n      display: 'flex',\r\n      alignItems: 'center',\r\n      transformStyle: 'preserve-3d',\r\n      flexDirection: 'row',\r\n    },\r\n    '& button': {\r\n      color: 'white',\r\n      transformStyle: 'preserve-3d',\r\n    },\r\n    '& > div:first-child': {\r\n      flex: 1,\r\n    },\r\n    '& > div:last-child': {\r\n      marginLeft: 'auto',\r\n    },\r\n  },\r\n}));\r\n","import React from 'react';\r\nimport { Box } from '@mui/material';\r\n\r\nimport PlayToggle from './play_toggle';\r\nimport Refresh from './refresh';\r\nimport ModeOptions from './mode_options';\r\nimport AlarmToggle from './alarm_toggle';\r\nimport Snapshot from './snapshot';\r\nimport TheaterMode from './theater_mode';\r\nimport FollowToggle from './follow_toggle';\r\nimport FullscreenToggle from './fullscreen_toggle';\r\nimport PTZToggle from './ptz_toggle';\r\nimport Volume from './volume';\r\nimport MicToggle from './mic';\r\nimport { mergeAndSortChildren } from 'utils/video';\r\nimport { IPlayerWebRTCProps } from 'types/player';\r\nimport { useStyles } from './styles';\r\n\r\nfunction ControlBar(props: any) {\r\n  const { controlBar } = props as IPlayerWebRTCProps;\r\n\r\n  if (controlBar?.hide) return null;\r\n\r\n  const classes = useStyles();\r\n\r\n  const getDefaultLeftChildren = () => {\r\n    return [\r\n      <PlayToggle key=\"play-toggle\" order={1} />,\r\n      <Refresh key=\"refresh\" order={2} />,\r\n      <ModeOptions key=\"mode\" order={3} />,\r\n    ];\r\n  };\r\n\r\n  const getDefaultRightChildren = () => {\r\n    return [\r\n      <MicToggle key=\"mic-toggle\" order={6} />,\r\n      <AlarmToggle key=\"alarm-toggle\" order={7} />,\r\n      <Volume key=\"volume\" order={8} />,\r\n      <PTZToggle key=\"ptz-toggle\" order={9} />,\r\n      <Snapshot key=\"snapshot\" order={10} />,\r\n      <TheaterMode key=\"theater-mode\" order={11} />,\r\n      <FollowToggle key=\"follow-toggle\" order={12} />,\r\n      <FullscreenToggle key=\"fullscreen-toggle\" order={13} />,\r\n    ];\r\n  };\r\n\r\n  const getLeftChildren = () => {\r\n    const children = React.Children.toArray(props.children);\r\n    const defaultChildren = getDefaultLeftChildren();\r\n\r\n    return mergeAndSortChildren(defaultChildren, children, { ...props });\r\n  };\r\n\r\n  const getRightChildren = () => {\r\n    const children = React.Children.toArray(props.children);\r\n    const defaultChildren = getDefaultRightChildren();\r\n\r\n    return mergeAndSortChildren(defaultChildren, children, { ...props });\r\n  };\r\n\r\n  return (\r\n    <Box className={classes.controlBar}>\r\n      <Box>{getLeftChildren()}</Box>\r\n      <Box>{getRightChildren()}</Box>\r\n    </Box>\r\n  );\r\n}\r\n\r\nexport default ControlBar;\r\n","let isDebug = true;\r\n\r\nexport function initDebugLog(newDebug = true) {\r\n  isDebug = newDebug;\r\n}\r\n\r\nexport function debugLog(text: any) {\r\n  if (!isDebug) return;\r\n  console.log(text);\r\n}\r\n","import { debugLog } from './log';\r\n\r\nclass Fullscreen {\r\n  request(elm: any) {\r\n    debugLog('Fullscreen.request: request fullscreen');\r\n    if (elm.requestFullscreen) {\r\n      elm.requestFullscreen();\r\n    } else if (elm.webkitRequestFullscreen) {\r\n      elm.webkitRequestFullscreen();\r\n    } else if (elm.mozRequestFullscreen) {\r\n      elm.mozRequestFullscreen();\r\n    } else if (elm.msRequestFullscreen) {\r\n      elm.msRequestFullscreen();\r\n    }\r\n  }\r\n\r\n  exit() {\r\n    debugLog('Fullscreen.exit: exit fullscreen');\r\n    if (document.exitFullscreen) {\r\n      document.exitFullscreen();\r\n    }\r\n    // else if (document.webkitExitFullscreen) {\r\n    //   document.webkitExitFullscreen();\r\n    // } else if (document.mozCancelFullScreen) {\r\n    //   document.mozCancelFullScreen();\r\n    // } else if (document.msExitFullscreen) {\r\n    //   document.msExitFullscreen();\r\n    // }\r\n  }\r\n\r\n  get isFullscreen() {\r\n    return document.fullscreenElement ? true : false;\r\n    // document.webkitFullscreenElement ||\r\n    // document.mozFullScreenElement ||\r\n    // document.msFullscreenElement\r\n  }\r\n\r\n  get enabled() {\r\n    return document.fullscreenEnabled;\r\n    // document.webkitFullscreenEnabled ||\r\n    // document.mozFullScreenEnabled ||\r\n    // document.msFullscreenEnabled\r\n  }\r\n\r\n  addEventListener(handler: any) {\r\n    document.addEventListener('fullscreenchange', handler);\r\n    document.addEventListener('webkitfullscreenchange', handler);\r\n    document.addEventListener('mozfullscreenchange', handler);\r\n    document.addEventListener('MSFullscreenChange', handler);\r\n  }\r\n\r\n  removeEventListener(handler: any) {\r\n    document.removeEventListener('fullscreenchange', handler);\r\n    document.removeEventListener('webkitfullscreenchange', handler);\r\n    document.removeEventListener('mozfullscreenchange', handler);\r\n    document.removeEventListener('MSFullscreenChange', handler);\r\n  }\r\n}\r\n\r\nexport default new Fullscreen();\r\n","import { useEffect } from 'react';\r\n\r\nimport { IPlayerWebRTCProps } from 'types/player';\r\nimport fullscreen from 'utils/fullscreen';\r\n\r\nfunction Shortcut(props: any) {\r\n  const { actions } = props as IPlayerWebRTCProps;\r\n\r\n  useEffect(() => {\r\n    fullscreen.addEventListener(exitHandler);\r\n    return () => fullscreen.removeEventListener(exitHandler);\r\n  }, []);\r\n\r\n  const exitHandler = () => {\r\n    if (fullscreen.isFullscreen) return;\r\n    actions.changeFullscreen(fullscreen.isFullscreen);\r\n  };\r\n\r\n  return null;\r\n}\r\n\r\nexport default Shortcut;\r\n","import { createSlice } from '@reduxjs/toolkit';\r\n\r\nimport { IPlayerWebRTCSlice } from 'types/player';\r\n\r\nconst initialState: IPlayerWebRTCSlice = {\r\n  paused: true,\r\n  isFullscreen: false,\r\n  waiting: false,\r\n  isWsOpen: false,\r\n  isMuted: true,\r\n  isAlarm: false,\r\n  isAudioStarting: false,\r\n  isAudioNotSupport: false,\r\n  error: null,\r\n};\r\n\r\nconst playerSlice = createSlice({\r\n  initialState,\r\n  name: 'playerSlice',\r\n  reducers: {\r\n    changeFullscreen: (state, action) => {\r\n      state.isFullscreen = action.payload;\r\n    },\r\n    play: (state) => {\r\n      state.paused = false;\r\n      state.waiting = false;\r\n    },\r\n    playing: (state) => {\r\n      state.waiting = false;\r\n    },\r\n    canPlay: (state) => {\r\n      state.waiting = false;\r\n    },\r\n    canPlayThrough: (state) => {\r\n      state.waiting = false;\r\n    },\r\n    pause: (state) => {\r\n      state.paused = true;\r\n    },\r\n    waiting: (state) => {\r\n      state.waiting = true;\r\n    },\r\n    mute: (state) => {\r\n      state.isMuted = true;\r\n    },\r\n    unmute: (state) => {\r\n      state.isMuted = false;\r\n    },\r\n    startAlarm: (state) => {\r\n      state.isAlarm = true;\r\n    },\r\n    stopAlarm: (state) => {\r\n      state.isAlarm = false;\r\n    },\r\n    startAudio: (state) => {\r\n      state.isAudioStarting = true;\r\n    },\r\n    stopAudio: (state) => {\r\n      state.isAudioStarting = false;\r\n    },\r\n    setIsAudioNotSupport: (state) => {\r\n      state.isAudioNotSupport = true;\r\n    },\r\n    wsOpenSuccess: (state) => {\r\n      state.isWsOpen = true;\r\n      console.log('state.isWsOpen', state.isWsOpen)\r\n    },\r\n    setError: (state, action) => {\r\n      state.error = action.payload;\r\n      state.waiting = false;\r\n    },\r\n    setPeerConnectionIssue: (state, action) => {\r\n      state.peerConnectionIssue = action.payload;\r\n    },\r\n  },\r\n});\r\n\r\nexport const { reducer, actions } = playerSlice;\r\nexport const { setError } = actions;\r\nexport const { wsOpenSuccess } = actions;\r\nexport default reducer;\r\n","import playerSlice from './webrtc/slice';\r\n\r\nconst rootReducer = {\r\n  playerSlice,\r\n};\r\n\r\nexport default rootReducer;\r\n","import { IPlayerWebRTCSlice } from 'types/player';\r\nimport fullscreen from 'utils/fullscreen';\r\n\r\nexport function snapshot(this: any) {\r\n  const { video } = this.video;\r\n\r\n  if (!video) return;\r\n\r\n  const { videoHeight, videoWidth } = video;\r\n\r\n  const canvas = document.createElement('canvas');\r\n  const context = canvas.getContext('2d');\r\n\r\n  if (!context) return;\r\n\r\n  canvas.width = videoWidth;\r\n  canvas.height = videoHeight;\r\n\r\n  context.fillRect(0, 0, videoWidth, videoHeight);\r\n  context.drawImage(video, 0, 0, videoWidth, videoHeight);\r\n\r\n  const link = document.createElement('a');\r\n  link.setAttribute('download', `snapshot_${new Date().getTime()}.jpg`);\r\n  link.setAttribute('href', canvas.toDataURL('image/URL').replace('image/png', 'image/octet-stream'));\r\n  link.click();\r\n}\r\n\r\nexport function toggleFullscreen(rootElement: HTMLElement, player: IPlayerWebRTCSlice) {\r\n  if (!rootElement) return;\r\n\r\n  if (fullscreen.enabled) {\r\n    if (fullscreen.isFullscreen && player.isFullscreen) {\r\n      fullscreen.exit();\r\n    } else {\r\n      fullscreen.request(rootElement);\r\n    }\r\n  }\r\n\r\n  return {\r\n    type: 'playerSlice/changeFullscreen',\r\n    payload: !player.isFullscreen,\r\n  };\r\n}\r\n","import { Store, configureStore } from '@reduxjs/toolkit';\r\n\r\nimport reducer from 'components/player_webrtc/redux_store/root_reducer';\r\nimport * as otherActions from 'components/player_webrtc/redux_store/webrtc/action';\r\nimport { IPlayerWebRTCActions } from 'types/player';\r\nimport { actions as playerActions } from 'components/player_webrtc/redux_store/webrtc/slice';\r\nimport { RootState } from 'components/player_webrtc/redux_store/store';\r\nimport Video from './video';\r\n\r\nexport default class Manager {\r\n  store: Store;\r\n  video: Video | null;\r\n  rootElement: HTMLElement | null;\r\n\r\n  constructor() {\r\n    this.store = configureStore({ reducer, devTools: false });\r\n    this.video = null;\r\n    this.rootElement = null;\r\n  }\r\n\r\n  getState(): RootState {\r\n    return this.store.getState();\r\n  }\r\n\r\n  getActions() {\r\n    const { dispatch } = this.store;\r\n    const actions = Object.assign({}, playerActions, otherActions);\r\n\r\n    const bindActionCreator = (actionCreator: any) => {\r\n      const self = this;\r\n      return function bindAction(...args: any) {\r\n        const action = actionCreator.apply(self, args);\r\n        if (typeof action !== 'undefined') dispatch(action);\r\n      };\r\n    };\r\n\r\n    return Object.keys(actions)\r\n      .filter((key) => typeof actions[key as keyof IPlayerWebRTCActions] === 'function')\r\n      .reduce((boundActions, key) => {\r\n        boundActions[key as keyof IPlayerWebRTCActions] = bindActionCreator(actions[key as keyof IPlayerWebRTCActions]);\r\n        return boundActions;\r\n      }, {} as IPlayerWebRTCActions);\r\n  }\r\n\r\n  subscribeToStateChange(listener: (state: any, preState: any) => void, getState: () => void) {\r\n    if (!getState) {\r\n      getState = this.getState.bind(this);\r\n    }\r\n\r\n    let preState = getState();\r\n\r\n    const handleChange = () => {\r\n      const state = getState();\r\n      if (state === preState) return;\r\n\r\n      const prevStateCopy = preState;\r\n      preState = state;\r\n      listener(state, prevStateCopy);\r\n    };\r\n\r\n    this.store.subscribe(handleChange);\r\n  }\r\n\r\n  subscribeToPlayerStateChange(listener: () => void) {\r\n    return this.subscribeToStateChange(listener, () => this.getState().playerSlice);\r\n  }\r\n}\r\n","import React, { useState } from 'react';\r\nimport { Refresh } from '@mui/icons-material';\r\nimport { Box, Typography, CircularProgress, IconButton } from '@mui/material';\r\n\r\nimport { CameraStatusEnum } from 'types/player';\r\n\r\ninterface VideoStatusProps {\r\n  status: CameraStatusEnum;\r\n  wsOpen?: boolean;\r\n  error: {\r\n    message: string;\r\n    detail?: string;\r\n  } | null;\r\n}\r\n\r\nfunction VideoStatus(props: VideoStatusProps) {\r\n  const { status, error, wsOpen } = props;\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  let des = '';\r\n  let reconnect = false;\r\n\r\n  if (!wsOpen) {\r\n    des = 'Không thể kết nối tới máy chủ';\r\n    reconnect = true;\r\n  }\r\n\r\n  if (status === CameraStatusEnum.ERROR) {\r\n    des = 'Camera đang lỗi';\r\n    reconnect = false;\r\n  }\r\n\r\n  if (status === CameraStatusEnum.OFFLINE) {\r\n    des = 'Camera đang tắt';\r\n    reconnect = false;\r\n  }\r\n\r\n  if (error) {\r\n    des = error.message;\r\n  }\r\n\r\n  const handleSignalingReConnect = async () => {\r\n    setLoading(true);\r\n    setTimeout(() => {\r\n      //   dispatch(setWsReconnection(true));\r\n      setLoading(false);\r\n    }, 3200);\r\n  };\r\n\r\n  return (\r\n    <Box\r\n      position=\"absolute\"\r\n      top=\"50%\"\r\n      left=\"50%\"\r\n      sx={{\r\n        transform: 'translate(-50%, -50%)',\r\n      }}\r\n      textAlign=\"center\"\r\n    >\r\n      {loading ? (\r\n        <React.Fragment>\r\n          <Typography color=\"white\" variant=\"body2\" mb={3}>\r\n            Đang kết nối đến máy chủ\r\n          </Typography>\r\n          <CircularProgress style={{ color: 'white' }} size={32} />\r\n        </React.Fragment>\r\n      ) : (\r\n        <React.Fragment>\r\n          <Typography color=\"white\" variant=\"body2\" mb={2}>\r\n            {des}\r\n          </Typography>\r\n          {!wsOpen && reconnect && (\r\n            <IconButton onClick={handleSignalingReConnect}>\r\n              <Refresh style={{ color: 'white' }} fontSize=\"large\" />\r\n            </IconButton>\r\n          )}\r\n        </React.Fragment>\r\n      )}\r\n    </Box>\r\n  );\r\n}\r\n\r\nexport default VideoStatus;\r\n","import { styled } from '@mui/styles';\r\n\r\nexport const VideoWrapper = styled('div')({\r\n  width: '100%',\r\n  height: '100%',\r\n  outline: 'none',\r\n  position: 'absolute',\r\n  top: 0,\r\n  left: 0,\r\n});\r\n\r\nexport const VideoStyled = styled('video')({\r\n  display: 'block',\r\n  width: '100%',\r\n  height: '100%',\r\n  position: 'absolute',\r\n  outline: 0,\r\n  '&::-webkit-media-controls': {\r\n    display: 'none !important',\r\n  },\r\n});\r\n","import { Action, configureStore, ThunkDispatch } from '@reduxjs/toolkit';\r\nimport { TypedUseSelectorHook, useDispatch, useSelector } from 'react-redux';\r\nimport reducer from './root_reducer';\r\n\r\nexport const store = configureStore({\r\n  reducer,\r\n  devTools: false,\r\n});\r\n\r\n// Infer the `RootState` and `AppDispatch` types from the store itself\r\nexport type RootState = ReturnType<typeof store.getState>;\r\n// Inferred type: {posts: PostsState, comments: CommentsState, users: UsersState}\r\nexport type AppDispatch = typeof store.dispatch;\r\n\r\nexport type ThunkAppDispatch = ThunkDispatch<RootState, void, Action>;\r\n\r\nexport const useAppDispatch = () => useDispatch<ThunkAppDispatch>();\r\nexport const useAppSelector: TypedUseSelectorHook<RootState> = useSelector;\r\n","import { IRequestMessage, IResponseMessage, TViewerResponseStatus } from 'types/message';\r\nimport { IPlayerWebRTCActions } from 'types/player';\r\nimport { debugLog, initDebugLog } from 'utils/log';\r\nimport RTC from './rtc';\r\n\r\nimport { store } from 'components/player_webrtc/redux_store/store';\r\nimport { wsOpenSuccess } from 'components/player_webrtc/redux_store/webrtc/slice';\r\n\r\ninterface ISignalingConnect {\r\n  serverAddress: string;\r\n  debug?: boolean;\r\n}\r\n\r\nclass Signaling {\r\n  ws?: WebSocket;\r\n  rtcList: Map<string, RTC>;\r\n  timeoutId?: NodeJS.Timeout;\r\n  disconnectNumber: number;\r\n  debug?: boolean;\r\n  actions?: IPlayerWebRTCActions;\r\n\r\n  constructor() {\r\n    this.rtcList = new Map<string, RTC>();\r\n    this.disconnectNumber = 0;\r\n    this.debug = false;\r\n  }\r\n\r\n  connect = async ({serverAddress, debug}: ISignalingConnect) => {\r\n    try {\r\n      this.debug = debug;\r\n      initDebugLog(debug);\r\n\r\n      // this.actions = actions;\r\n\r\n      debugLog({ '[Signaling.connect]': 'wss://dev.danateq.vn/signaling' });\r\n      this.ws = new WebSocket(serverAddress);\r\n\r\n      this.ws.onopen = this.wsOnOpen;\r\n      this.ws.onmessage = this.wsOnMessage;\r\n    } catch (error) {\r\n      debugLog({ '[Signaling.connectError]': error });\r\n    }\r\n  };\r\n\r\n  wsAuth = async (token: string) => {\r\n    this.sendMessage({\r\n      id: 'authen',\r\n      token,\r\n    });\r\n  };\r\n\r\n  wsOnOpen = async () => {\r\n    // await this.wsAuth();\r\n\r\n    console.log('wsOpen 111');\r\n\r\n    // this.actions?.wsOpenSuccess();\r\n\r\n    // const [rtc] = Array.from(this.rtcList.values());\r\n    // rtc?.initTrack(null);\r\n  };\r\n\r\n  wsOnMessage = (message: any) => {\r\n    const parsedMessage: IResponseMessage = JSON.parse(message.data);\r\n    const viewerId = parsedMessage.viewerId as string;\r\n\r\n    const rtc = this.rtcList.get(viewerId);\r\n\r\n    switch (parsedMessage.id) {\r\n      case 'authen':\r\n        // console.log({actions: this.actions})\r\n        if (parsedMessage.authenStatus === 'success') {\r\n          store.dispatch(wsOpenSuccess());\r\n          // this.actions?.wsOpenSuccess();\r\n        }\r\n        break;\r\n      case 'camera':\r\n        debugLog({ '[Signaling.wsOnMessage.case.camera]': rtc });\r\n        if (!rtc) return;\r\n        rtc.createPcPeerConnection();\r\n        break;\r\n      case 'viewerAccepted':\r\n        if (!rtc) return;\r\n        this.viewerResponse(parsedMessage, 'accepted');\r\n        break;\r\n      case 'viewerRejected':\r\n        if (!rtc) return;\r\n        this.viewerResponse(parsedMessage, 'rejected');\r\n        break;\r\n      case 'iceCandidate':\r\n        if (!rtc) return;\r\n        if (parsedMessage.iceCandidate) {\r\n          const candidate = parsedMessage.iceCandidate;\r\n          if (candidate) {\r\n            if (!rtc.pc) return;\r\n            if (rtc.pc.remoteDescription) {\r\n              rtc.pc.addIceCandidate({\r\n                candidate: candidate.candidate,\r\n                sdpMid: candidate.sdpMid,\r\n                sdpMLineIndex: candidate.sdpMLineIndex,\r\n              });\r\n            } else {\r\n              rtc.iceCandidateQueue.push(candidate);\r\n            }\r\n          }\r\n        }\r\n        break;\r\n      case 'viewerError':\r\n        debugLog({ '[Signaling.wsOnMessage.viewerError]': { parsedMessage, rtc } });\r\n        if (!rtc) return;\r\n        rtc.actions.setError({ message: parsedMessage.error });\r\n        break;\r\n      case 'signalingError':\r\n        debugLog({ '[Signaling.wsOnMessage.signalingError]': { parsedMessage } });\r\n        // this.actions?.setError({ message: parsedMessage.error });\r\n        break;\r\n      default:\r\n        console.warn('unrecognized message', parsedMessage);\r\n        break;\r\n    }\r\n  };\r\n\r\n  addRtc = (viewerId: string, rtc: RTC) => {\r\n    this.rtcList.set(viewerId, rtc);\r\n  };\r\n\r\n  sendMessage = (message: IRequestMessage) => {\r\n    const jsonMessage = JSON.stringify(message);\r\n    if (this.ws && this.ws.readyState === WebSocket.OPEN) {\r\n      this.ws.send(jsonMessage);\r\n    } else {\r\n      console.warn('ws.readyState != WebSocket.OPEN');\r\n    }\r\n  };\r\n\r\n  viewerResponse = (message: IResponseMessage, status: TViewerResponseStatus) => {\r\n    if (status === 'rejected') {\r\n      const errorMsg = message.error || ' Unknown error';\r\n      console.warn('viewerResponse rejected: ', errorMsg);\r\n\r\n      return this.dispose(message.viewerId);\r\n    }\r\n\r\n    if (status === 'accepted') {\r\n      if (!message.sdpAnswer) return;\r\n      const sdpAnswer = message.sdpAnswer;\r\n      const viewerId = message.viewerId as string;\r\n\r\n      const rtc = this.rtcList.get(viewerId);\r\n      return rtc?.acceptOffer('answer', sdpAnswer);\r\n    }\r\n  };\r\n\r\n  dispose = (viewerId?: string) => {\r\n    debugLog({ '[Signaling.dispose]': viewerId });\r\n    this.close();\r\n    if (!viewerId) return;\r\n    const rtc = this.rtcList.get(viewerId);\r\n    rtc?.close();\r\n  };\r\n\r\n  close = () => {\r\n    debugLog({ '[Signaling.close] closed': this.timeoutId });\r\n    if (this.timeoutId) {\r\n      clearTimeout(this.timeoutId);\r\n      this.disconnectNumber = 0;\r\n      this.timeoutId = undefined;\r\n    }\r\n\r\n    this.rtcList.clear();\r\n\r\n    if (!this.ws || this.ws.readyState === WebSocket.CLOSED) return;\r\n    this.ws.close();\r\n  };\r\n}\r\n\r\nexport const signaling = new Signaling();\r\nexport default Signaling;\r\n","import { v4 as uuidv4 } from 'uuid';\r\nimport { IPlayerWebRTCActions } from 'types/player';\r\nimport { debugLog } from 'utils/log';\r\nimport { signaling } from './signaling';\r\nimport { IRequestMessage } from 'types/message';\r\n\r\ninterface IRTCProps {\r\n  cameraId: string;\r\n  actions: IPlayerWebRTCActions;\r\n  audioStarting?: boolean;\r\n  isSupportAudio?: boolean;\r\n}\r\n\r\nlet peerConnectionLimit = 0;\r\nlet peerConnectionIssue = 0;\r\n\r\nconst urls = 'turn:10.49.46.162:30478?transport=tcp',\r\n  credential = 'turnpass',\r\n  username = 'turnuser';\r\n\r\nconst RTCConfig: RTCConfiguration =\r\n  urls && credential && username\r\n    ? {\r\n        iceServers: [\r\n          {\r\n            urls,\r\n            username,\r\n            credential,\r\n          },\r\n        ],\r\n        iceTransportPolicy: 'all',\r\n      }\r\n    : {};\r\n\r\nexport default class RTC {\r\n  pc: RTCPeerConnection | null = null;\r\n  video: HTMLVideoElement | null = null;\r\n  cameraId: string;\r\n  viewerId: string;\r\n  iceCandidateQueue: any[];\r\n  actions: IPlayerWebRTCActions;\r\n  audioStarting?: boolean;\r\n  isSupportAudio?: boolean;\r\n  peerConnectionTimeoutId?: any;\r\n\r\n  constructor(props: IRTCProps) {\r\n    this.cameraId = props.cameraId;\r\n    this.viewerId = uuidv4();\r\n    this.iceCandidateQueue = [];\r\n    this.actions = props.actions;\r\n    this.audioStarting = props.audioStarting;\r\n    this.isSupportAudio = props.isSupportAudio;\r\n    this.peerConnectionTimeoutId = 0;\r\n  }\r\n\r\n  initTrack = (video: HTMLVideoElement | null) => {\r\n    debugLog(`RTC.initTrack, cameraId: ${this.cameraId}, viewerId: ${this.viewerId}`);\r\n    this.video = video || this.video;\r\n\r\n    signaling.sendMessage({\r\n      id: 'camera',\r\n      cameraId: this.cameraId,\r\n      viewerId: this.viewerId,\r\n    });\r\n  };\r\n\r\n  getNetWorkStatus = () => {\r\n    if (!this.pc) return;\r\n\r\n    this.pc.getStats().then((stats: RTCStatsReport) => {\r\n      stats.forEach((report) => {\r\n        if (report.type === 'candidate-pair') {\r\n          const { currentRoundTripTime = 0 } = report;\r\n\r\n          if (currentRoundTripTime >= 3) {\r\n            peerConnectionIssue += 1;\r\n\r\n            if (peerConnectionIssue >= 5) {\r\n              //setError\r\n              peerConnectionIssue = 0;\r\n            }\r\n          }\r\n        }\r\n      });\r\n    });\r\n  };\r\n\r\n  startAudioStream = async () => {\r\n    if (!window.localStream) return;\r\n    const localStream: MediaStream = window.localStream;\r\n    localStream.getAudioTracks().forEach((track) => this.pc?.addTrack(track, localStream));\r\n  };\r\n\r\n  stopAudioStream = () => {\r\n    if (!window.localStream) return;\r\n    const localStream: MediaStream = window.localStream;\r\n    localStream.getAudioTracks().forEach((track) => track.stop());\r\n  };\r\n\r\n  onIceCandidate = (candidate: RTCIceCandidate) => {\r\n    const message: IRequestMessage = {\r\n      id: 'iceCandidate',\r\n      cameraId: this.cameraId,\r\n      viewerId: this.viewerId,\r\n      iceCandidate: candidate,\r\n    };\r\n\r\n    signaling.sendMessage(message);\r\n  };\r\n\r\n  createPcPeerConnection = async () => {\r\n    try {\r\n      console.log({RTCConfig})\r\n      this.pc = new RTCPeerConnection(RTCConfig);\r\n      debugLog(`[RTC.createPeerConnection]: ${this.pc}`);\r\n\r\n      peerConnectionLimit += 1;\r\n\r\n      setInterval(this.getNetWorkStatus, 10000);\r\n\r\n      if (this.audioStarting) {\r\n        this.startAudioStream();\r\n      }\r\n\r\n      this.pc.onicecandidate = (e) => {\r\n        if (!e.candidate) return;\r\n        this.onIceCandidate(e.candidate);\r\n      };\r\n\r\n      this.pc.ontrack = (e) => {\r\n        if (!this.video) return;\r\n        this.video.srcObject = e.streams[0];\r\n      };\r\n\r\n      this.pc.onicecandidateerror = (ev: any) => {\r\n        debugLog({ '[RTC.onicecandidateerror]': ev });\r\n        this.actions.setError({\r\n          message: ev.errorText || 'Lỗi không xác định',\r\n        });\r\n      };\r\n\r\n      this.pc.onconnectionstatechange = (ev: any) => {\r\n        let timeout = 0;\r\n        if (this.pc?.iceConnectionState === 'disconnected') {\r\n          debugLog({ '[RTC.onconnectionstatechange]': ev });\r\n\r\n          if (this.peerConnectionTimeoutId) return;\r\n\r\n          this.peerConnectionTimeoutId = setInterval(() => {\r\n            timeout++;\r\n\r\n            //6s\r\n            if (timeout >= 6) {\r\n              this.actions.setError({ message: 'Đã xảy ra lỗi khi kết nối đến máy chủ' });\r\n            }\r\n          }, 1000);\r\n        }\r\n      };\r\n\r\n      if (!this.audioStarting) {\r\n        this.actions.waiting();\r\n      }\r\n\r\n      await this.createOffer();\r\n    } catch (error) {\r\n      debugLog(`[RTC.createPeerConnection]: ${error}`);\r\n      if (error?.message && peerConnectionLimit >= 256) {\r\n        this.actions.setError({ message: 'Cannot create peerConnection', detail: 'peerConnectionLimit' });\r\n        //set err\r\n    }\r\n    }\r\n  };\r\n\r\n  \r\n\r\n  createOffer = async () => {\r\n    if (!this.pc) return;\r\n\r\n    const offerToReceiveAudio = this.audioStarting ? false : this.isSupportAudio || false;\r\n    const offerToReceiveVideo = this.audioStarting ? false : true;\r\n\r\n    const offer = await this.pc.createOffer({\r\n      offerToReceiveAudio,\r\n      offerToReceiveVideo,\r\n    });\r\n\r\n    const message: IRequestMessage = {\r\n      id: 'startViewer',\r\n      cameraId: this.cameraId,\r\n      viewerId: this.viewerId,\r\n      sdpOffer: offer.sdp,\r\n    };\r\n\r\n    signaling.sendMessage(message);\r\n    this.pc.setLocalDescription(offer);\r\n  };\r\n\r\n  acceptOffer = async (type: RTCSdpType, sdp: string) => {\r\n    debugLog({ '[RTC.acceptOffer]': this.pc });\r\n\r\n    if (!this.pc) return;\r\n\r\n    await this.pc.setRemoteDescription({\r\n      type,\r\n      sdp,\r\n    });\r\n\r\n    if (this.iceCandidateQueue.length > 0) {\r\n      while (this.iceCandidateQueue.length) {\r\n        const candidate: RTCIceCandidateInit = this.iceCandidateQueue.shift();\r\n\r\n        this.pc.addIceCandidate({\r\n          candidate: candidate.candidate,\r\n          sdpMid: candidate.sdpMid,\r\n          sdpMLineIndex: candidate.sdpMLineIndex,\r\n        });\r\n      }\r\n    }\r\n\r\n    if (this.audioStarting) {\r\n      this.toggleAudio('startAudio');\r\n    }\r\n  };\r\n\r\n  toggleAudio = (id: 'startAudio' | 'stopAudio') => {\r\n    const message: IRequestMessage = {\r\n      id,\r\n      cameraId: this.cameraId,\r\n      viewerId: this.viewerId,\r\n    };\r\n\r\n    signaling.sendMessage(message);\r\n  };\r\n\r\n  toggleAlarm = (id: 'startAlarm' | 'stopAlarm') => {\r\n    const message: IRequestMessage = {\r\n        id,\r\n        cameraId: this.cameraId,\r\n        viewerId: this.viewerId\r\n    }\r\n    \r\n    signaling.sendMessage(message)\r\n  }\r\n\r\n  close = () => {\r\n    debugLog(`RTC.close cameraId: ${this.cameraId}, viewerId: ${this.viewerId}`);\r\n\r\n    if (this.peerConnectionTimeoutId) {\r\n      clearInterval(this.peerConnectionTimeoutId);\r\n      this.peerConnectionTimeoutId = undefined;\r\n    }\r\n\r\n    if (!this.pc) return;\r\n\r\n    this.pc.close();\r\n    this.pc.onicecandidate = null;\r\n    this.pc.ontrack = null;\r\n    this.pc.onnegotiationneeded = null;\r\n    this.pc.onconnectionstatechange = null;\r\n    this.pc.onicegatheringstatechange = null;\r\n    this.pc.onsignalingstatechange = null;\r\n    this.pc = null;\r\n\r\n    const message: IRequestMessage = {\r\n      id: 'stop',\r\n      cameraId: this.cameraId,\r\n      viewerId: this.viewerId,\r\n    };\r\n\r\n    signaling.sendMessage(message);\r\n  };\r\n}\r\n","import React, { Component } from 'react';\r\nimport { CameraStatusEnum, IPlayerWebRTCProps } from 'types/player';\r\n\r\nimport VideoStatus from './status';\r\nimport { toastMessage } from 'utils/common';\r\nimport { debugLog } from 'utils/log';\r\nimport { VideoStyled, VideoWrapper } from './styles';\r\nimport { signaling } from '../controller/signaling';\r\nimport RTC from '../controller/rtc';\r\nimport { store } from 'components/player_webrtc/redux_store/store';\r\n\r\nconst { NORMAL, WARNING } = CameraStatusEnum;\r\n\r\nexport default class Video extends Component<any> {\r\n  video: HTMLVideoElement | null;\r\n  rtc: RTC = new RTC({\r\n    actions: this.props.actions,\r\n    cameraId: this.props.cam.id,\r\n    isSupportAudio: this.props.cam.isSupportAudio,\r\n  });\r\n  rtcAudio: RTC | null = null;\r\n\r\n  constructor(props: IPlayerWebRTCProps) {\r\n    super(props);\r\n    this.video = null;\r\n\r\n    // this.init();\r\n    // this.rtc =\r\n    //   props.cam.status === ERROR || props.cam.status === OFFLINE\r\n    //     ? null\r\n    //     : new RTC({ cameraId: props.cam.id, actions: props.actions, isSupportAudio: props.cam.isSupportAudio });\r\n  }\r\n\r\n  get actions() {\r\n    const { actions: newActions } = this.props as IPlayerWebRTCProps;\r\n    return newActions;\r\n  }\r\n\r\n  get player() {\r\n    const { player: newPlayer } = this.props as IPlayerWebRTCProps;\r\n    return newPlayer;\r\n  }\r\n\r\n  set muted(val: boolean) {\r\n    if (!this.video) return;\r\n    this.video.muted = val;\r\n  }\r\n\r\n  componentDidMount() {\r\n    console.log('componentDidMount', signaling?.ws?.readyState === WebSocket.OPEN);\r\n    // console.log('componentDidMount', signaling.ws?.readyState);\r\n    // if (!signaling.ws) return toastMessage.error('cannot connect signaling server');\r\n    // if (signaling.ws.readyState === WebSocket.OPEN) return this.startPlayer();\r\n    this.startPlayer()\r\n  }\r\n\r\n  componentDidUpdate(prevProps: IPlayerWebRTCProps) {\r\n    console.log('componentDidMount', signaling?.ws?.readyState === WebSocket.OPEN);\r\n    // if (prevProps.player.isAudioStarting !== this.props?.player?.isAudioStarting) {\r\n    //   if (this.props?.player?.isAudioStarting) {\r\n    //     this.rtcAudio = new RTC({ cameraId: this.props.cam.id, actions: this.actions, isSupportAudio: true });\r\n    //     this.startPlayer(this.rtcAudio.viewerId, this.rtcAudio);\r\n    //   } else {\r\n    //     if (!this.rtcAudio) return;\r\n    //     this.rtcAudio.toggleAudio('stopAudio');\r\n    //     this.rtcAudio.close();\r\n    //     this.rtcAudio.stopAudioStream();\r\n    //   }\r\n    // }\r\n\r\n\r\n    console.log({ prevProps: prevProps.player, props: this.props.player });\r\n\r\n    if (this.props?.player.error && prevProps.player.error !== this.props.player.error) {\r\n      // this.stopPlayer();\r\n    }\r\n\r\n    if (this.props.player.isWsOpen && prevProps.player.isWsOpen !== this.props.player.isWsOpen) {\r\n      // this.startPlayer();\r\n      // if (this.props?.player.error) {\r\n      //   this.stopPlayer();\r\n      // } else {\r\n      //   console.log('componentDidUpdate')\r\n      //   this.startPlayer();\r\n      // }\r\n      // console.log('this.props.player.isWsOpen', this.props.player.isWsOpen);\r\n    }\r\n  }\r\n\r\n  componentWillUnmount(): void {\r\n    this.stopPlayer();\r\n  }\r\n\r\n  startPlayer = (viewerId?: string, rtc?: RTC) => {\r\n    if (!this.rtc) return toastMessage.error('not found RTC');\r\n    signaling.addRtc(viewerId || this.rtc.viewerId, rtc || this.rtc);\r\n\r\n    if (rtc) {\r\n      return rtc.initTrack(this.video);\r\n    } else {\r\n      return this.rtc.initTrack(this.video);\r\n    }\r\n  };\r\n\r\n  stopPlayer = () => {\r\n    if (!this.rtc) return;\r\n    debugLog({ '[Video.stopPlayer]': this.rtc });\r\n\r\n    this.rtc.close();\r\n    this.rtcAudio?.close();\r\n    this.rtcAudio?.stopAudioStream();\r\n\r\n    return this.handlePause();\r\n  };\r\n\r\n  handleCanPlay = () => {\r\n    if (!this.video) return;\r\n    return this.actions.canPlay();\r\n  };\r\n\r\n  handlePlaying = () => {\r\n    if (!this.video) return;\r\n    return this.actions.playing();\r\n  };\r\n\r\n  handlePlay = () => {\r\n    if (!this.rtc?.pc) return;\r\n    if (!this.video) return toastMessage.error('Not found video');\r\n    this.actions.play();\r\n    return this.video.play();\r\n  };\r\n\r\n  handlePause = () => {\r\n    if (!this.video) return toastMessage.error('Not found video');\r\n    if (this.player.paused) return;\r\n\r\n    this.actions.pause();\r\n    return this.video.pause();\r\n  };\r\n\r\n  handleCanPlayThrough = () => {\r\n    if (!this.video) return;\r\n    return this.actions.canPlayThrough();\r\n  };\r\n\r\n  handleError = () => {\r\n    debugLog('[CPN.video]: handle error');\r\n  };\r\n\r\n  renderContent() {\r\n    const {\r\n      cam: { status },\r\n      player: { error, isMuted = false },\r\n      // wsOpen = false,\r\n    } = this.props as IPlayerWebRTCProps;\r\n\r\n    console.log({ state: store.getState().playerSlice });\r\n\r\n    if ((status === NORMAL || status === WARNING) && !error)\r\n      return (\r\n        <VideoStyled\r\n          width=\"100%\"\r\n          height={220}\r\n          ref={(c) => (this.video = c)}\r\n          autoPlay\r\n          muted={isMuted}\r\n          onError={this.handleError}\r\n          onPlay={this.handlePlay}\r\n          onPlaying={this.handlePlaying}\r\n          onCanPlay={this.handleCanPlay}\r\n          onPause={this.handlePause}\r\n          onCanPlayThrough={this.handleCanPlayThrough}\r\n        />\r\n      );\r\n\r\n    return <VideoStatus status={WARNING} error={error} wsOpen={true} />;\r\n  }\r\n\r\n  render() {\r\n    return <VideoWrapper>{this.renderContent()}</VideoWrapper>;\r\n  }\r\n}\r\n","import { styled } from '@mui/styles';\r\n\r\nexport const VideoDanaPlayer = styled('div')({\r\n  width: '100%',\r\n  background: '#000',\r\n  height: 0,\r\n  transformStyle: 'preserve-3d',\r\n  paddingTop: '56.25%',\r\n  maxHeight: '100%',\r\n  '&:hover div:last-child': {\r\n    opacity: 1,\r\n    visibility: 'visible',\r\n  },\r\n});\r\n","import React from 'react';\r\nimport { Component } from 'react';\r\n\r\nimport { ICamProps, IManager, IPlayerWebRTCControlBar, IPlayerWebRTCProps, IPlayerWebRTCSlice } from 'types/player';\r\nimport { mergeAndSortChildren } from 'utils/video';\r\nimport CameraName from 'components/camera_name';\r\nimport Loading from 'components/loading';\r\nimport ControlBar from 'components/control_bar';\r\nimport Shortcut from 'components/shortcut';\r\nimport Manager from '../manager';\r\nimport Video from '../video';\r\nimport { VideoDanaPlayer } from './styles';\r\n// import { signaling } from '../controller/signaling';\r\n\r\n// export interface IPlayerRTCProps {\r\n//   cam: ICamProps;\r\n//   // wsOpen: boolean;\r\n//   isTheaterMode?: boolean;\r\n//   isFollowDisabled?: boolean;\r\n//   isHideControlBar?: boolean;\r\n// }\r\n\r\nexport interface IPlayerRTCProps {\r\n  cam: ICamProps;\r\n  controlBar?: IPlayerWebRTCControlBar;\r\n}\r\n\r\nexport default class PlayerRTC extends Component<IPlayerRTCProps> {\r\n  manager = new Manager();\r\n  actions = this.manager.getActions();\r\n\r\n  constructor(props: IPlayerRTCProps) {\r\n    super(props);\r\n    this.manager.subscribeToPlayerStateChange(this.handleStateChange.bind(this));\r\n  }\r\n\r\n  getChildren = (props: IPlayerWebRTCProps) => {\r\n    const { ...propsWithoutChildren } = props;\r\n\r\n    const defaultChildren = this.getDefaultChildren();\r\n    return mergeAndSortChildren(defaultChildren, [], propsWithoutChildren);\r\n  };\r\n\r\n  getDefaultChildren = () => {\r\n    return [\r\n      <Video\r\n        key=\"video\"\r\n        ref={(c: Video) => {\r\n          this.manager.video = c;\r\n        }}\r\n        order={0.0}\r\n      />,\r\n      <CameraName key=\"name\" order={1.0} />,\r\n      <Loading key=\"loading\" order={2.0} />,\r\n      <ControlBar key=\"control-bar\" order={3.0} />,\r\n      <Shortcut key=\"shortcut\" order={4.0} />,\r\n    ];\r\n  };\r\n\r\n  handleStateChange = () => {\r\n    this.forceUpdate();\r\n  };\r\n\r\n  render() {\r\n    const playerSlice: IPlayerWebRTCSlice = this.manager.getState().playerSlice;\r\n\r\n    const props: IPlayerWebRTCProps = {\r\n      ...this.props,\r\n      player: playerSlice,\r\n      actions: this.actions,\r\n      manager: this.manager as IManager,\r\n      store: this.manager.store,\r\n    };\r\n\r\n    const children = this.getChildren(props);\r\n\r\n    return (\r\n      <VideoDanaPlayer ref={(c: HTMLElement | null) => (this.manager.rootElement = c)}>{children}</VideoDanaPlayer>\r\n    );\r\n  }\r\n}\r\n","import { styled } from '@mui/styles';\n\nexport const VideoWrapper = styled('div')({\n  position: 'absolute',\n  width: '100%',\n  height: '100%',\n  outline: 'none',\n  top: 0,\n  left: 0,\n});\n\nexport const VideoStyled = styled('video')({\n  display: 'block',\n  width: '100%',\n  height: '100%',\n  position: 'absolute',\n  outline: 0,\n  '&::-webkit-media-controls': {\n    display: 'none !important',\n  },\n});\n","import React from 'react';\nimport { Typography } from '@mui/material';\n\nimport { VideoWrapper } from '../styles';\nimport { CameraStatusEnum } from 'types/player';\n\nfunction VideoStatus({ status, error }: { status: CameraStatusEnum; error?: { message: string } }) {\n  let des = '';\n\n  if (status === CameraStatusEnum.ERROR) {\n    des = 'Camera đang lỗi';\n  }\n\n  if (status === CameraStatusEnum.OFFLINE) {\n    des = 'Camera đang tắt';\n  }\n\n  if (error) {\n    des = error.message;\n  }\n\n  return (\n    <VideoWrapper>\n      <Typography\n        position=\"absolute\"\n        top=\"50%\"\n        left=\"50%\"\n        color=\"white\"\n        variant=\"body2\"\n        sx={{\n          transform: 'translate(-50%, -50%)',\n        }}\n      >\n        {des}\n      </Typography>\n    </VideoWrapper>\n  );\n}\n\nexport default VideoStatus;\n","import React, { Component } from 'react';\nimport Hls from 'hls.js';\n\n// import { IPlayerProps } from '../../types/player';\n// import { debugLog } from '../../utils/log';\n// import { VideoStyled, VideoWrapper } from './styles';\n// import { CameraStatusEnum } from 'src/types/stream';\n// import store from 'redux_store';\nimport VideoStatus from './status';\nimport { CameraStatusEnum, IPlayerProps } from 'types/player';\nimport { debugLog } from 'utils/log';\nimport { VideoStyled, VideoWrapper } from './styles';\n\nconst { ERROR, NORMAL, OFFLINE, WARNING } = CameraStatusEnum;\n\nconst hlsOption = {\n  backBufferLength: 0,\n\n  xhrSetup: (xhr: any) => {\n    // const {\n    //   me: { id },\n    //   token,\n    // } = store.getState().myAccountSlice;\n\n    xhr.setRequestHeader('Authorization', 'Bearer=' + 'VFkSwavnX6nrRM6Ha9P2crM0B7I0Ze3sJMBi9mfL');\n    xhr.setRequestHeader('user_id', '62861e795faf626463105272');\n  },\n  debug: true,\n};\n\nexport default class Video extends Component<any> {\n  video: HTMLVideoElement | null = null;\n  //   slice = this.props as IPlayerProps;\n  hls: Hls | null = null;\n\n  constructor(props: IPlayerProps) {\n    super(props);\n    this.hls = props.cam.status === ERROR || props.cam.status === OFFLINE ? null : new Hls(hlsOption);\n  }\n\n  get actions() {\n    const { actions: newActions } = this.props as IPlayerProps;\n    return newActions;\n  }\n\n  get player() {\n    const { player: newPlayer } = this.props as IPlayerProps;\n    return newPlayer;\n  }\n\n  componentDidUpdate(prevProps: IPlayerProps) {\n    // if (prevProps.cam.id !== this.props.cam.id) {\n    //   this.startPlayer(false);\n    // }\n\n    if (prevProps.player.isFullscreen !== this.props.player.isFullscreen) {\n      this.startPlayer(this.props.player.isFullscreen);\n    }\n\n    if (this.props?.player.error) {\n      this.destroyHls();\n    }\n  }\n\n  componentDidMount() {\n    if (!this.hls) return;\n    this.video?.addEventListener('pause', this.onPauseVideo);\n\n    this.startPlayer(false);\n\n    if (Hls.isSupported()) {\n      this.hls.on(Hls.Events.ERROR, (_event, data) => {\n        if (!this.hls) return;\n        if (data.fatal) {\n          switch (data.type) {\n            case Hls.ErrorTypes.NETWORK_ERROR:\n              if (data.networkDetails?.status === 404) {\n                this.actions.setError({ message: 'Không tìm thấy tệp' });\n                break;\n              }\n              console.log('fatal network error encountered, try to recover');\n              this.hls.startLoad();\n              break;\n            case Hls.ErrorTypes.MEDIA_ERROR:\n              console.log('fatal media error encountered, try to recover', data);\n              this.hls.recoverMediaError();\n              break;\n            default:\n              console.log('fatal default', { data });\n              this.hls.startLoad();\n              // this.hls.destroy();\n              break;\n          }\n        }\n      });\n    }\n  }\n\n  componentWillUnmount() {\n    this.video?.removeEventListener('pause', this.onPauseVideo);\n    this.destroyHls();\n  }\n\n  onPauseVideo = () => {\n    if (document.hidden) {\n      this.play();\n    }\n  };\n\n  destroyHls = () => {\n    if (this.hls) {\n      this.hls.destroy();\n    }\n  };\n\n  resetHls = () => {\n    this.destroyHls();\n    this.hls = new Hls(hlsOption);\n  };\n\n  startPlayer = (isFullscreen: boolean) => {\n    if (!this.hls) return;\n    this.resetHls();\n\n    const video = this.video;\n    if (!video) return;\n\n    if (Hls.isSupported()) {\n      this.hls.detachMedia();\n      this.hls.attachMedia(video);\n\n      this.hls.on(Hls.Events.MEDIA_ATTACHED, () => {\n        if (!this.hls) return;\n\n        const path = `${this.props.cam.id}`;\n        // const path = isFullscreen || this.slice.isTheaterMode ? `${this.props.cam.id}` : `${this.props.cam.id}_sub`;\n        this.hls.loadSource(`/video/livestream/${path}/index.m3u8`);\n        video.play().catch((error) => console.log(error));\n      });\n    }\n\n    this.hls.on(Hls.Events.MANIFEST_PARSED, function () {\n      const promise = video.play();\n      if (promise === undefined) {\n        console.log('🚀 video.play() undefined', isFullscreen);\n      }\n      if (promise !== undefined) {\n        promise\n          .catch((error) => console.log({ error }))\n          .then(() => {\n            console.log('🚀 Play');\n          });\n      }\n    });\n  };\n\n  onPlay = () => this.handlePlay();\n\n  onPause = () => this.handlePause();\n\n  handleError = () => {\n    debugLog('🚀 ~ CPN.video: handle error');\n  };\n\n  handlePause = () => {\n    // const { player } = this.slice;\n    if (this.player.paused || !this.video) return;\n    this.pause();\n  };\n\n  handlePlay = () => {\n    if (!this.hls) return;\n    this.play();\n  };\n\n  play = () => {\n    if (!this.video) return;\n    // const { actions } = this.slice;\n\n    const promise = this.video.play();\n    if (promise !== undefined)\n      promise\n        .catch(() => {\n          if (!this.video) return;\n          this.video.pause();\n          this.actions.pause();\n        })\n        .then(() => {\n          this.actions.play();\n        });\n  };\n\n  pause = () => {\n    if (!this.video) return;\n    // const { actions } = this.slice;\n\n    this.actions.pause();\n    this.video.pause();\n  };\n\n  onSeeking = () => {\n    debugLog('🚀 ~ CPN.video: onSeeking');\n    if (!this.video) return;\n    // const { actions } = this.slice;\n\n    this.actions.seeking();\n    this.video.play();\n  };\n\n  onSeeked = () => {\n    debugLog('🚀 ~ CPN.video: onSeeked');\n    if (!this.video) return;\n    // const { actions } = this.slice;\n\n    this.actions.seeked();\n    this.play();\n  };\n\n  onEnded = () => {\n    debugLog('🚀 ~ CPN.video: onEnded');\n  };\n\n  onWaiting = () => {\n    debugLog('🚀 ~ CPN.video: onWaiting');\n    // const { actions } = this.slice;\n\n    this.actions.waiting();\n    this.handlePause();\n  };\n\n  onCanPlay = () => {\n    debugLog('🚀 ~ CPN.video.onCanPlay');\n    if (!this.video) return;\n    // const { actions } = this.slice;\n\n    this.actions.canPlay();\n  };\n\n  onPlaying = () => {\n    debugLog('🚀 ~ CPN.video.onPlaying');\n    if (!this.video) return;\n    // const { actions } = this.slice;\n\n    this.actions.playing();\n  };\n\n  onCanPlayThrough = (e: React.BaseSyntheticEvent) => {\n    debugLog({ '🚀 ~ CPN.video.onCanPlayThrough': e });\n    if (!this.video) return;\n    // const { actions } = this.slice;\n    this.actions.canPlayThrough();\n  };\n\n  render() {\n    const {\n      player,\n      cam: { status },\n    } = this.props;\n\n    if ((status === NORMAL || status === WARNING) && !player.error)\n      return (\n        <VideoWrapper>\n          <VideoStyled\n            crossOrigin=\"anonymous\"\n            ref={(c) => (this.video = c)}\n            muted\n            autoPlay\n            onSeeking={this.onSeeking}\n            onSeeked={this.onSeeked}\n            onEnded={this.onEnded}\n            onError={this.handleError}\n            onPlay={this.onPlay}\n            onCanPlay={this.onCanPlay}\n            onPause={this.onPause}\n            onWaiting={this.onWaiting}\n            onPlaying={this.onPlaying}\n            onCanPlayThrough={this.onCanPlayThrough}\n          />\n        </VideoWrapper>\n      );\n\n    return <VideoStatus status={status} error={player.error} key=\"video\" />;\n  }\n}\n","import { createSlice } from '@reduxjs/toolkit';\nimport { IPlayerHlsSlice } from 'types/player';\n\n\nconst initialState: IPlayerHlsSlice = {\n  paused: true,\n  isFullscreen: false,\n  waiting: false,\n  seeking: false,\n  error: null,\n  showControlBar: false,\n};\n\nconst playerSlice = createSlice({\n  initialState,\n  name: 'player_record',\n  reducers: {\n    changeFullscreen: (state, action) => {\n      state.isFullscreen = action.payload;\n    },\n    playToggle: (state) => {\n      state.paused = !state.paused;\n    },\n    play: (state) => {\n      state.paused = false;\n      state.waiting = false;\n    },\n    playing: (state) => {\n      state.waiting = false;\n    },\n    canPlay: (state) => {\n      state.waiting = false;\n    },\n    canPlayThrough: (state) => {\n      state.waiting = false;\n    },\n    controlBarActive: (state, action) => {\n      state.showControlBar = action.payload;\n    },\n    pause: (state) => {\n      state.paused = true;\n    },\n    seeking: (state) => {\n      state.seeking = true;\n    },\n    seeked: (state) => {\n      state.seeking = false;\n    },\n    waiting: (state) => {\n      state.waiting = true;\n    },\n    setError: (state, action) => {\n      state.error = action.payload;\n    },\n  },\n});\n\nexport const { reducer, actions } = playerSlice;\nexport default reducer;\n","import playerSlice from \"./player/player_slice\";\n\nconst rootReducer = {\n  playerSlice,\n};\n\nexport default rootReducer;\n","// import { IPlayer } from '../../types/player';\nimport { IPlayerHlsSlice } from 'types/player';\nimport fullscreen from 'utils/fullscreen';\n\nexport function snapshot(this: any) {\n  const { video } = this.video;\n\n  if (!video) return;\n\n  const { videoHeight, videoWidth } = video;\n\n  const canvas = document.createElement('canvas');\n  const context = canvas.getContext('2d');\n\n  if (!context) return;\n\n  canvas.width = videoWidth;\n  canvas.height = videoHeight;\n\n  context.fillRect(0, 0, videoWidth, videoHeight);\n  context.drawImage(video, 0, 0, videoWidth, videoHeight);\n\n  const link = document.createElement('a');\n  link.setAttribute('download', `snapshot_${new Date().getTime()}.jpg`);\n  link.setAttribute('href', canvas.toDataURL('image/URL').replace('image/png', 'image/octet-stream'));\n  link.click();\n}\n\nexport function toggleFullscreen(rootElement: HTMLElement, player: IPlayerHlsSlice) {\n  if (!rootElement) return;\n\n  if (fullscreen.enabled) {\n    if (fullscreen.isFullscreen) {\n      fullscreen.exit();\n    } else {\n      fullscreen.request(rootElement);\n    }\n  }\n\n  return {\n    type: 'player_record/changeFullscreen',\n    payload: !player.isFullscreen,\n  };\n}\n","import { Store, configureStore } from '@reduxjs/toolkit';\r\n\r\nimport reducer from './redux_store/root_reducer';\r\nimport * as otherActions from './redux_store/player/player_action';\r\nimport { IPlayerHlsActions } from 'types/player';\r\nimport { actions as playerActions } from './redux_store/player/player_slice';\r\nimport { RootState } from './redux_store/store';\r\nimport Video from './video';\r\n\r\nexport default class Manager {\r\n  store: Store;\r\n  video: Video | null;\r\n  rootElement: HTMLElement | null;\r\n\r\n  constructor() {\r\n    this.store = configureStore({ reducer, devTools: false });\r\n    this.video = null;\r\n    this.rootElement = null;\r\n  }\r\n\r\n  getState(): RootState {\r\n    return this.store.getState();\r\n  }\r\n\r\n  getActions() {\r\n    const { dispatch } = this.store;\r\n    const actions = Object.assign({}, playerActions, otherActions);\r\n\r\n    const bindActionCreator = (actionCreator: any) => {\r\n      const self = this;\r\n      return function bindAction(...args: any) {\r\n        const action = actionCreator.apply(self, args);\r\n        if (typeof action !== 'undefined') dispatch(action);\r\n      };\r\n    };\r\n\r\n    return Object.keys(actions)\r\n      .filter((key) => typeof actions[key as keyof IPlayerHlsActions] === 'function')\r\n      .reduce((boundActions, key) => {\r\n        boundActions[key as keyof IPlayerHlsActions] = bindActionCreator(actions[key as keyof IPlayerHlsActions]);\r\n        return boundActions;\r\n      }, {} as IPlayerHlsActions);\r\n  }\r\n\r\n  subscribeToStateChange(listener: (state: any, preState: any) => void, getState: () => void) {\r\n    if (!getState) {\r\n      getState = this.getState.bind(this);\r\n    }\r\n\r\n    let preState = getState();\r\n\r\n    const handleChange = () => {\r\n      const state = getState();\r\n      if (state === preState) return;\r\n\r\n      const prevStateCopy = preState;\r\n      preState = state;\r\n      listener(state, prevStateCopy);\r\n    };\r\n\r\n    this.store.subscribe(handleChange);\r\n  }\r\n\r\n  subscribeToPlayerStateChange(listener: () => void) {\r\n    return this.subscribeToStateChange(listener, () => this.getState().playerSlice);\r\n  }\r\n}\r\n","import { styled } from '@mui/styles';\n\nexport const VideoDanaPlayer = styled('div')({\n  width: '100%',\n  background: '#000',\n  height: 0,\n  transformStyle: 'preserve-3d',\n  paddingTop: '56.25%',\n  maxHeight: '100%',\n  '&:hover div:last-child': {\n    opacity: 1,\n    visibility: 'visible',\n  },\n});\n","import React, { Component } from 'react';\n\nimport Video from '../video';\nimport Manager from '../manager';\nimport { ICamProps, IManager, IPlayerHlsSlice, IPlayerProps } from 'types/player';\nimport { mergeAndSortChildren } from 'utils/video';\nimport ControlBar from 'components/control_bar';\nimport CameraName from 'components/camera_name';\nimport Loading from 'components/loading';\nimport { VideoDanaPlayer } from './styles';\nimport Shortcut from 'components/shortcut';\n\ninterface IPlayerComponentProps {\n  cam: ICamProps;\n  isFollowDisabled?: boolean;\n  isTheaterMode?: boolean;\n  isHideControlBar?: boolean;\n}\n\nexport default class Player extends Component<IPlayerComponentProps> {\n  manager = new Manager();\n  actions = this.manager.getActions();\n\n  constructor(props: IPlayerComponentProps) {\n    super(props);\n\n    this.manager.subscribeToPlayerStateChange(this.handleStateChange.bind(this));\n  }\n\n  getChildren = (props: IPlayerProps) => {\n    const { ...propsWithoutChildren } = props;\n\n    const defaultChildren = this.getDefaultChildren();\n    return mergeAndSortChildren(defaultChildren, [], propsWithoutChildren);\n  };\n\n  renderControlBar = () => {\n    const playerSlice: IPlayerHlsSlice = this.manager.getState().playerSlice;\n    if (!playerSlice.showControlBar) return <React.Fragment></React.Fragment>;\n\n    // const { status, classifiedListId } = this.props.cam;\n    // const { OFFLINE, ERROR } = CameraStatusEnum;\n\n    // if ((status === OFFLINE || status === ERROR) && !classifiedListId) return <></>;\n\n    return <ControlBar key=\"control-bar\" order={3.0} />;\n  };\n\n  getDefaultChildren = () => {\n    return [\n      <Video\n        key=\"video\"\n        ref={(c: Video) => {\n          this.manager.video = c;\n        }}\n        order={0.0}\n      />,\n      <CameraName key=\"name\" order={1.0} />,\n      <Loading key=\"loading\" order={2.0} />,\n      this.renderControlBar(),\n      <Shortcut key=\"shortcut\" />,\n    ];\n  };\n\n  handleStateChange = () => {\n    this.forceUpdate();\n  };\n\n  handleMouseEnter = () => {\n    this.actions.controlBarActive(true);\n  };\n\n  handleMouseLeave = () => {\n    this.actions.controlBarActive(false);\n  };\n\n  render() {\n    const playerSlice: IPlayerHlsSlice = this.manager.getState().playerSlice;\n\n    const props: IPlayerProps = {\n      ...this.props,\n      player: playerSlice,\n      actions: this.actions,\n      manager: this.manager as IManager,\n      store: this.manager.store,\n    };\n\n    const children = this.getChildren(props);\n\n    return (\n      <VideoDanaPlayer\n        ref={(c: HTMLElement | null) => (this.manager.rootElement = c)}\n        onMouseEnter={this.handleMouseEnter}\n        onMouseLeave={this.handleMouseLeave}\n      >\n        {children}\n      </VideoDanaPlayer>\n    );\n  }\n}\n","import * as React from 'react';\nimport { I18nextProvider } from 'react-i18next';\n\nimport i18n from 'i18n';\nimport PlayerRTC from 'components/player_webrtc';\nimport { signaling } from 'components/player_webrtc/controller/signaling';\nimport { ICamProps, IPlayerWebRTCControlBar } from './types/player';\nimport { toastMessage } from 'utils/common';\nimport PlayerHls from 'components/player_hls';\n\nexport declare interface IPlayerStreamProps {\n  type: 'hls' | 'rtc';\n  cam: ICamProps;\n  controlBar?: IPlayerWebRTCControlBar;\n}\n\ninterface ISignalingConfig {\n  token: string;\n  serverAddress: string;\n}\n\nexport const useSignaling = ({ token, serverAddress }: ISignalingConfig) => {\n  const [wsOpen, setWsOpen] = React.useState(false);\n\n  React.useEffect(() => {\n    signaling.connect({ serverAddress, debug: true });\n    if (signaling.ws) {\n      signaling.ws.onopen = async () => {\n        await signaling.wsAuth(token);\n        setWsOpen(true);\n      };\n    }\n  }, []);\n\n  return { wsOpen };\n};\n\nexport const initI18n = (locale: string) => {\n  i18n.changeLanguage(locale);\n};\n\nexport const PlayerStream = (props: IPlayerStreamProps) => {\n  const renderContent = () => {\n    if (props.type === 'hls') return <PlayerHls {...props} />;\n    if (props.type === 'rtc') return <PlayerRTC {...props} />;\n\n    return toastMessage.error('Loại không hợp lệ');\n  };\n  return (\n    <I18nextProvider i18n={i18n}>\n      <h3>{props.type}</h3>\n\n      {renderContent()}\n    </I18nextProvider>\n  );\n};\n","export const cameras = [\n  {\n    name: 'P4 - Cam 6 - Lạc Long Quân - Hai Bà Trưng',\n    lat: 15.910633058361,\n    lng: 108.339717444143,\n    address: 'Phường Cẩm An, Thành phố Hội An, Tỉnh Quảng Nam',\n    ip: '192.168.20.166',\n    portOnvif: '80',\n    portRtsp: '554',\n    isSharedLink: false,\n    status: 'normal',\n    isSupportAudio: false,\n    isSupportPtz: true,\n    recordMaxKeepDay: 0,\n    isEnabledMic: false,\n    isEnabledPTZ: false,\n    isEnabledSpeaker: false,\n    isSyncDateTime: false,\n    id: '64006db163a8b81e520f960d',\n  },\n  {\n    address: 'Phường Cẩm Phô, Thành phố Hội An, Tỉnh Quảng Nam',\n    id: '6400673b63a8b81e520f95c3',\n    ip: '192.168.20.181',\n    isEnabledMic: false,\n    isEnabledPTZ: false,\n    isEnabledSpeaker: false,\n    isSharedLink: false,\n    isSupportAudio: true,\n    isSupportPtz: true,\n    isSyncDateTime: true,\n    lat: 15.879233012730094,\n    lng: 108.32115878537732,\n    name: 'P2 - Cam 1 - Hùng Vương 18/8',\n    portOnvif: '80',\n    portRtsp: '554',\n    recordMaxKeepDay: 0,\n    status: 'normal',\n  },\n  {\n    name: 'P4 - Cam 6 - Lạc Long Quân - Hai Bà Trưng',\n    lat: 15.910633058361,\n    lng: 108.339717444143,\n    address: 'Phường Cẩm An, Thành phố Hội An, Tỉnh Quảng Nam',\n    ip: '192.168.20.166',\n    portOnvif: '80',\n    portRtsp: '554',\n    isSharedLink: false,\n    status: 'normal',\n    isSupportAudio: false,\n    isSupportPtz: true,\n    recordMaxKeepDay: 0,\n    isEnabledMic: false,\n    isEnabledPTZ: false,\n    isEnabledSpeaker: false,\n    isSyncDateTime: false,\n    id: '640068a163a8b81e520f95cd',\n  },\n  {\n    name: 'Thọ Quang 2',\n    lat: 16.0987219824992,\n    lng: 108.243948894409,\n    address: 'Phường Thọ Quang, Quận Sơn Trà, Thành phố Đà Nẵng',\n    ip: '',\n    portOnvif: '',\n    portRtsp: '',\n    isSharedLink: true,\n    status: 'offline',\n    isSupportAudio: false,\n    isSupportPtz: false,\n    recordMaxKeepDay: 0,\n    id: '6357b50f78337e74066777a7',\n  },\n  {\n    name: 'Thọ Quang 3',\n    lat: 16.0980622624656,\n    lng: 108.241502719788,\n    address: 'Phường Thọ Quang, Quận Sơn Trà, Thành phố Đà Nẵng',\n    ip: '',\n    portOnvif: '',\n    portRtsp: '',\n    isSharedLink: true,\n    status: 'offline',\n    isSupportAudio: false,\n    isSupportPtz: false,\n    recordMaxKeepDay: 0,\n    id: '6357b76b78337e74066777ab',\n  },\n  {\n    name: 'VMS Hải Châu - Trần Phú - Hùng Vương',\n    lat: 16.06863003837401,\n    lng: 108.22387398127579,\n    address: 'Phường Hải Châu I, Quận Hải Châu, Thành phố Đà Nẵng',\n    ip: '',\n    portOnvif: '',\n    portRtsp: '',\n    isSharedLink: true,\n    status: 'offline',\n    isSupportAudio: false,\n    isSupportPtz: false,\n    recordMaxKeepDay: 0,\n    id: '6371b23a79071a09c354b653',\n  },\n  {\n    name: 'VMS Hải Châu - Trần Phú - Trần Quốc Toản',\n    lat: 16.064984248098614,\n    lng: 108.22358363214992,\n    address: 'Phường Phước Ninh, Quận Hải Châu, Thành phố Đà Nẵng',\n    ip: '',\n    portOnvif: '',\n    portRtsp: '',\n    isSharedLink: true,\n    status: 'offline',\n    isSupportAudio: false,\n    isSupportPtz: false,\n    recordMaxKeepDay: 0,\n    id: '6371b1ec79071a09c354b650',\n  },\n  {\n    name: 'VMS Hải Châu - Trần Quốc Toản - Bạch Đằng',\n    lat: 16.0649326987999,\n    lng: 108.224124767819,\n    address: 'Phường Phước Ninh, Quận Hải Châu, Thành phố Đà Nẵng',\n    ip: '',\n    portOnvif: '',\n    portRtsp: '',\n    isSharedLink: true,\n    status: 'offline',\n    isSupportAudio: false,\n    isSupportPtz: false,\n    recordMaxKeepDay: 0,\n    id: '6371b17c79071a09c354b64d',\n  },\n  {\n    name: 'Vận hành - 233 Trưng Nữ Vương',\n    lat: 16.0593720365003,\n    lng: 108.22243757811,\n    address: 'Phường Thanh Bình, Quận Hải Châu, Thành phố Đà Nẵng',\n    ip: '',\n    portOnvif: '',\n    portRtsp: '',\n    isSharedLink: true,\n    status: 'offline',\n    isSupportAudio: false,\n    isSupportPtz: false,\n    recordMaxKeepDay: 7,\n    id: '6336a6fc02805b3ff3453c04',\n  },\n  {\n    name: 'Vận hành - 235 Núi Thành',\n    lat: 16.0544402009763,\n    lng: 108.2202016295,\n    address: 'Phường Thạch Thang, Quận Hải Châu, Thành phố Đà Nẵng',\n    ip: '',\n    portOnvif: '',\n    portRtsp: '',\n    isSharedLink: true,\n    status: 'offline',\n    isSupportAudio: false,\n    isSupportPtz: false,\n    recordMaxKeepDay: 0,\n    id: '635106d8787f615c86cf10a4',\n  },\n  {\n    name: 'Vận hành - 236 Núi Thành',\n    lat: 16.0544941299203,\n    lng: 108.220195578897,\n    address: 'Phường Thanh Bình, Quận Hải Châu, Thành phố Đà Nẵng',\n    ip: '',\n    portOnvif: '',\n    portRtsp: '',\n    isSharedLink: true,\n    status: 'offline',\n    isSupportAudio: false,\n    isSupportPtz: false,\n    recordMaxKeepDay: 0,\n    id: '6371a49e79071a09c354b64a',\n  },\n  {\n    name: 'Vận hành - 237 Trưng Nữ Vương',\n    lat: 16.0545308028725,\n    lng: 108.219887589853,\n    address: 'Phường Hải Châu I, Quận Hải Châu, Thành phố Đà Nẵng',\n    ip: '',\n    portOnvif: '',\n    portRtsp: '',\n    isSharedLink: true,\n    status: 'offline',\n    isSupportAudio: false,\n    isSupportPtz: false,\n    recordMaxKeepDay: 0,\n    id: '635107c7787f615c86cf10a7',\n  },\n  {\n    name: 'danateq',\n    lat: 16.068001444254943,\n    lng: 108.20167728033451,\n    address: 'Phường Thuận Phước, Quận Hải Châu, Thành phố Đà Nẵng',\n    ip: '10.49.46.123',\n    portOnvif: '80',\n    portRtsp: '554',\n    isSharedLink: false,\n    status: 'normal',\n    isSupportAudio: true,\n    isSupportPtz: true,\n    recordMaxKeepDay: 0,\n    isEnabledMic: true,\n    isEnabledPTZ: true,\n    isEnabledSpeaker: true,\n    isSyncDateTime: true,\n    id: '643908ae645ee75c47b4a9d3',\n  },\n  {\n    name: 'test',\n    lat: 16.065857014669938,\n    lng: 108.18253703680423,\n    address: 'Phường Thanh Bình, Quận Hải Châu, Thành phố Đà Nẵng',\n    ip: '116.103.18.188',\n    portOnvif: '8095',\n    portRtsp: '8562',\n    isSharedLink: false,\n    status: 'normal',\n    isSupportAudio: false,\n    isSupportPtz: true,\n    recordMaxKeepDay: 0,\n    isEnabledMic: false,\n    isEnabledPTZ: false,\n    isEnabledSpeaker: false,\n    isSyncDateTime: true,\n    id: '6440b3169da9531dd912090e',\n  },\n  {\n    name: 'test2',\n    lat: 16.065857014669938,\n    lng: 108.18253703680423,\n    address: 'Phường Chiềng Lề, Thành phố Sơn La, Tỉnh Sơn La',\n    ip: '116.103.18.188',\n    portOnvif: '8094',\n    portRtsp: '8563',\n    isSharedLink: false,\n    status: 'offline',\n    isSupportAudio: false,\n    isSupportPtz: true,\n    recordMaxKeepDay: 0,\n    isEnabledMic: false,\n    isEnabledPTZ: false,\n    isEnabledSpeaker: false,\n    isSyncDateTime: false,\n    id: '6440b1a9af6752891229a3d7',\n  },\n  {\n    name: 'tets',\n    lat: 16.06396,\n    lng: 108.213479,\n    address: 'Phường Thanh Bình, Quận Hải Châu, Thành phố Đà Nẵng',\n    ip: '',\n    portOnvif: '',\n    portRtsp: '',\n    isSharedLink: true,\n    status: 'offline',\n    isSupportAudio: false,\n    isSupportPtz: false,\n    recordMaxKeepDay: 0,\n    isEnabledMic: false,\n    isEnabledPTZ: false,\n    isEnabledSpeaker: false,\n    isSyncDateTime: false,\n    id: '644b1c7399ee3138497bb76d',\n  },\n  {\n    name: 'Đếm lưu lượng - 12 Hà Huy Tập 3',\n    lat: 16.0592211441519,\n    lng: 108.185961023323,\n    address: 'Phường Hòa Khê, Quận Thanh Khê, Thành phố Đà Nẵng',\n    ip: '',\n    portOnvif: '',\n    portRtsp: '',\n    isSharedLink: true,\n    status: 'offline',\n    isSupportAudio: false,\n    isSupportPtz: false,\n    recordMaxKeepDay: 0,\n    id: '636b4a94854ba11c89d117f8',\n  },\n  {\n    name: 'Đếm lưu lượng - 14 Hà Huy Tập',\n    lat: 16.0591305728587,\n    lng: 108.186001449408,\n    address: 'Phường Hải Châu I, Quận Hải Châu, Thành phố Đà Nẵng',\n    ip: '',\n    portOnvif: '',\n    portRtsp: '',\n    isSharedLink: true,\n    status: 'offline',\n    isSupportAudio: false,\n    isSupportPtz: false,\n    recordMaxKeepDay: 7,\n    id: '63350b023cc4e4ac51ec2c0d',\n  },\n  {\n    name: 'Đỗ xe - 06 Trần Phú',\n    lat: 16.0816163199656,\n    lng: 108.222665020255,\n    address: 'Phường Hải Châu I, Quận Hải Châu, Thành phố Đà Nẵng',\n    ip: '',\n    isSharedLink: true,\n    status: 'normal',\n    recordMaxKeepDay: 7,\n    isSupportAudio: false,\n    isSupportPtz: true,\n    id: '6316cc5231cf54f0baddeb1e',\n  },\n  {\n    name: 'Đỗ xe - 17 Trần Phú',\n    lat: 16.0805818670547,\n    lng: 108.222919281052,\n    address: 'Phường Hải Châu I, Quận Hải Châu, Thành phố Đà Nẵng',\n    ip: '',\n    portOnvif: '',\n    portRtsp: '',\n    isSharedLink: true,\n    status: 'offline',\n    isSupportAudio: false,\n    isSupportPtz: false,\n    recordMaxKeepDay: 0,\n    id: '63510e8c787f615c86cf10b6',\n  },\n  {\n    name: 'Đỗ xe - 241 Trưng Nữ Vương',\n    lat: 16.0550875220744,\n    lng: 108.220134344344,\n    address: 'Phường Hải Châu I, Quận Hải Châu, Thành phố Đà Nẵng',\n    ip: '',\n    isSharedLink: true,\n    status: 'offline',\n    recordMaxKeepDay: 7,\n    isSupportAudio: false,\n    isSupportPtz: false,\n    id: '6316cc7f31cf54f0baddeb1f',\n  },\n  {\n    name: 'Đỗ xe - 242 Trưng Nữ Vương',\n    lat: 16.0545730313673,\n    lng: 108.219923176605,\n    address: 'Phường Hải Châu I, Quận Hải Châu, Thành phố Đà Nẵng',\n    ip: '',\n    portOnvif: '',\n    portRtsp: '',\n    isSharedLink: true,\n    status: 'offline',\n    isSupportAudio: false,\n    isSupportPtz: false,\n    recordMaxKeepDay: 7,\n    id: '6335083d3cc4e4ac51ec2bfc',\n  },\n];\n","import React from 'react';\n\nimport { PlayerStream, useSignaling } from 'player-dnt';\nimport 'player-dnt/dist/index.css';\nimport { cameras } from './data';\n\nconst token = 'fmudHuF0sniGQRxgmw16ODFyhCsX5vMeQ5EmJENc';\nconst serverAddress = 'wss://dev.danateq.vn/signaling';\n\nconst App = () => {\n  const { wsOpen = false } = useSignaling({ token, serverAddress });\n\n  if (!wsOpen) return null;\n\n  return (\n    <div\n      style={{\n        display: 'flex',\n        flexDirection: 'column',\n        alignItems: 'center',\n      }}\n    >\n      <h2>Demo Create react library</h2>\n      <div\n        style={{\n          width: 560,\n        }}\n      >\n        <PlayerStream\n          type=\"hls\"\n          cam={{\n            id: cameras[1].id,\n            name: cameras[1].name,\n            status: 'normal',\n          }}\n        />\n\n        <p></p>\n\n        <PlayerStream\n          type=\"rtc\"\n          cam={{\n            id: cameras[12].id,\n            name: cameras[12].name,\n            status: 'normal',\n          }}\n          // controlBar={{\n          //   hide: true,\n\n          // }}\n        />\n      </div>\n    </div>\n  );\n};\n\nexport default App;\n","import './index.css'\n\nimport React from 'react'\nimport ReactDOM from 'react-dom'\nimport App from './App'\n\nReactDOM.render(<App />, document.getElementById('root'))\n"],"sourceRoot":""}